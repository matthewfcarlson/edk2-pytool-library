



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Project Mu Documentation">
      
      
        <link rel="canonical" href="https://matthewc.dev/edk2-pytool-library/master/edk2toollib/log/ansi_handler/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Ansi handler - EDK2 Pytool Library</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../css/version-select.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#module-edk2toolliblogansi_handler" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://matthewc.dev/edk2-pytool-library/master/" title="EDK2 Pytool Library" aria-label="EDK2 Pytool Library" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              EDK2 Pytool Library
            </span>
            <span class="md-header-nav__topic">
              
                Ansi handler
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/matthewfcarlson/edk2-pytool-library/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://matthewc.dev/edk2-pytool-library/master/" title="EDK2 Pytool Library" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    EDK2 Pytool Library
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/matthewfcarlson/edk2-pytool-library/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../developing/" title="Developing" class="md-nav__link">
      Developing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../publishing/" title="Publishing" class="md-nav__link">
      Publishing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../using/" title="Using" class="md-nav__link">
      Using
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Features
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Features
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../features/logging.ansi_handler/" title="Logging.ansi handler" class="md-nav__link">
      Logging.ansi handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../features/utility_functions.GetHostInfo/" title="Utility functions.get host info" class="md-nav__link">
      Utility functions.get host info
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../features/windows_firmware_policy/" title="Windows firmware policy" class="md-nav__link">
      Windows firmware policy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../bin/" title="Bin" class="md-nav__link">
      Bin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../gitignore_parser/" title="Gitignore parser" class="md-nav__link">
      Gitignore parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../utility_functions/" title="Utility functions" class="md-nav__link">
      Utility functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Acpi
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Acpi
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../acpi/dmar_parser/" title="Dmar parser" class="md-nav__link">
      Dmar parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../acpi/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../acpi/ivrs_parser.md" title="Ivrs parser" class="md-nav__link">
      Ivrs parser
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6" type="checkbox" id="nav-6-6">
    
    <label class="md-nav__link" for="nav-6-6">
      Log
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-6">
        Log
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Ansi handler
      </label>
    
    <a href="./" title="Ansi handler" class="md-nav__link md-nav__link--active">
      Ansi handler
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_ansi_string" class="md-nav__link">
    get_ansi_string
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansicolor" class="md-nav__link">
    AnsiColor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#console_screen_buffer_info" class="md-nav__link">
    CONSOLE_SCREEN_BUFFER_INFO
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_1" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coloredformatter" class="md-nav__link">
    ColoredFormatter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_1" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_2" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converter" class="md-nav__link">
    converter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format" class="md-nav__link">
    format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatexception" class="md-nav__link">
    formatException
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatmessage" class="md-nav__link">
    formatMessage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatstack" class="md-nav__link">
    formatStack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formattime" class="md-nav__link">
    formatTime
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usestime" class="md-nav__link">
    usesTime
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coloredstreamhandler" class="md-nav__link">
    ColoredStreamHandler
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_2" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_3" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acquire" class="md-nav__link">
    acquire
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addfilter" class="md-nav__link">
    addFilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call_win32" class="md-nav__link">
    call_win32
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#close" class="md-nav__link">
    close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert_ansi" class="md-nav__link">
    convert_ansi
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#createlock" class="md-nav__link">
    createLock
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#emit" class="md-nav__link">
    emit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract_params" class="md-nav__link">
    extract_params
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter" class="md-nav__link">
    filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flush" class="md-nav__link">
    flush
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format_1" class="md-nav__link">
    format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_attrs" class="md-nav__link">
    get_attrs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_name" class="md-nav__link">
    get_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_win32_calls" class="md-nav__link">
    get_win32_calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle" class="md-nav__link">
    handle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handleerror" class="md-nav__link">
    handleError
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#release" class="md-nav__link">
    release
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removefilter" class="md-nav__link">
    removeFilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setformatter" class="md-nav__link">
    setFormatter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setlevel" class="md-nav__link">
    setLevel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setstream" class="md-nav__link">
    setStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_attrs" class="md-nav__link">
    set_attrs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_background" class="md-nav__link">
    set_background
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_console" class="md-nav__link">
    set_console
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_foreground" class="md-nav__link">
    set_foreground
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_name" class="md-nav__link">
    set_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write" class="md-nav__link">
    write
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_and_convert" class="md-nav__link">
    write_and_convert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_plain_text" class="md-nav__link">
    write_plain_text
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#win32console" class="md-nav__link">
    Win32Console
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-variables_4" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getconsolescreenbufferinfo" class="md-nav__link">
    GetConsoleScreenBufferInfo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setconsoletextattribute" class="md-nav__link">
    SetConsoleTextAttribute
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#winapi_test" class="md-nav__link">
    winapi_test
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wincolor" class="md-nav__link">
    WinColor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-variables_5" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../file_handler/" title="File handler" class="md-nav__link">
      File handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../junit_report_format/" title="Junit report format" class="md-nav__link">
      Junit report format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../markdown_handler/" title="Markdown handler" class="md-nav__link">
      Markdown handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../string_handler/" title="String handler" class="md-nav__link">
      String handler
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Tpm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        Tpm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tpm/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tpm/tpm2_defs/" title="Tpm2 defs" class="md-nav__link">
      Tpm2 defs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tpm/tpm2_policy_calc/" title="Tpm2 policy calc" class="md-nav__link">
      Tpm2 policy calc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tpm/tpm2_simulator/" title="Tpm2 simulator" class="md-nav__link">
      Tpm2 simulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tpm/tpm2_stream/" title="Tpm2 stream" class="md-nav__link">
      Tpm2 stream
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-8" type="checkbox" id="nav-6-8">
    
    <label class="md-nav__link" for="nav-6-8">
      Uefi
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-8">
        Uefi
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/authenticated_variables_structure_support/" title="Authenticated variables structure support" class="md-nav__link">
      Authenticated variables structure support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/bmp_object/" title="Bmp object" class="md-nav__link">
      Bmp object
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/fmp_auth_header/" title="Fmp auth header" class="md-nav__link">
      Fmp auth header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/fmp_capsule_header/" title="Fmp capsule header" class="md-nav__link">
      Fmp capsule header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/pi_firmware_file/" title="Pi firmware file" class="md-nav__link">
      Pi firmware file
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/pi_firmware_volume/" title="Pi firmware volume" class="md-nav__link">
      Pi firmware volume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/status_codes/" title="Status codes" class="md-nav__link">
      Status codes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/uefi_capsule_header/" title="Uefi capsule header" class="md-nav__link">
      Uefi capsule header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/uefi_multi_phase/" title="Uefi multi phase" class="md-nav__link">
      Uefi multi phase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/wincert/" title="Wincert" class="md-nav__link">
      Wincert
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-8-12" type="checkbox" id="nav-6-8-12">
    
    <label class="md-nav__link" for="nav-6-8-12">
      Edk2
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-8-12">
        Edk2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/fmp_payload_header/" title="Fmp payload header" class="md-nav__link">
      Fmp payload header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/ftw_working_block_format/" title="Ftw working block format" class="md-nav__link">
      Ftw working block format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/guid_list/" title="Guid list" class="md-nav__link">
      Guid list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/path_utilities/" title="Path utilities" class="md-nav__link">
      Path utilities
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/variablestore_manulipulations/" title="Variablestore manulipulations" class="md-nav__link">
      Variablestore manulipulations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/variable_format/" title="Variable format" class="md-nav__link">
      Variable format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-8-12-8" type="checkbox" id="nav-6-8-12-8">
    
    <label class="md-nav__link" for="nav-6-8-12-8">
      Build objects
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-6-8-12-8">
        Build objects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/build_objects/dsc.md" title="Dsc" class="md-nav__link">
      Dsc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/build_objects/dsc_translator.md" title="Dsc translator" class="md-nav__link">
      Dsc translator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/build_objects/index.md" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-8-12-9" type="checkbox" id="nav-6-8-12-9">
    
    <label class="md-nav__link" for="nav-6-8-12-9">
      Parsers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-6-8-12-9">
        Parsers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/base_parser/" title="Base parser" class="md-nav__link">
      Base parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/buildreport_parser/" title="Buildreport parser" class="md-nav__link">
      Buildreport parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/dec_parser/" title="Dec parser" class="md-nav__link">
      Dec parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/dsc_parser/" title="Dsc parser" class="md-nav__link">
      Dsc parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/fdf_parser/" title="Fdf parser" class="md-nav__link">
      Fdf parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/guid_parser/" title="Guid parser" class="md-nav__link">
      Guid parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/inf_parser/" title="Inf parser" class="md-nav__link">
      Inf parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/override_parser/" title="Override parser" class="md-nav__link">
      Override parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/targettxt_parser/" title="Targettxt parser" class="md-nav__link">
      Targettxt parser
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9" type="checkbox" id="nav-6-9">
    
    <label class="md-nav__link" for="nav-6-9">
      Windows
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-9">
        Windows
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/locate_tools/" title="Locate tools" class="md-nav__link">
      Locate tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9-3" type="checkbox" id="nav-6-9-3">
    
    <label class="md-nav__link" for="nav-6-9-3">
      Capsule
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-9-3">
        Capsule
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/capsule/cat_generator/" title="Cat generator" class="md-nav__link">
      Cat generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/capsule/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/capsule/inf_generator/" title="Inf generator" class="md-nav__link">
      Inf generator
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9-4" type="checkbox" id="nav-6-9-4">
    
    <label class="md-nav__link" for="nav-6-9-4">
      Policy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-9-4">
        Policy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/policy/firmware_policy.md" title="Firmware policy" class="md-nav__link">
      Firmware policy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/policy/index.md" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../developing/" title="Developing" class="md-nav__link">
      Developing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../publishing/" title="Publishing" class="md-nav__link">
      Publishing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../using/" title="Using" class="md-nav__link">
      Using
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Features
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Features
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../features/logging.ansi_handler/" title="Logging.ansi handler" class="md-nav__link">
      Logging.ansi handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../features/utility_functions.GetHostInfo/" title="Utility functions.get host info" class="md-nav__link">
      Utility functions.get host info
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../features/windows_firmware_policy/" title="Windows firmware policy" class="md-nav__link">
      Windows firmware policy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11" checked>
    
    <label class="md-nav__link" for="nav-11">
      Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../bin/" title="Bin" class="md-nav__link">
      Bin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../gitignore_parser/" title="Gitignore parser" class="md-nav__link">
      Gitignore parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../utility_functions/" title="Utility functions" class="md-nav__link">
      Utility functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-5" type="checkbox" id="nav-11-5">
    
    <label class="md-nav__link" for="nav-11-5">
      Acpi
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-5">
        Acpi
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../acpi/dmar_parser/" title="Dmar parser" class="md-nav__link">
      Dmar parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../acpi/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-6" type="checkbox" id="nav-11-6" checked>
    
    <label class="md-nav__link" for="nav-11-6">
      Log
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-6">
        Log
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Ansi handler
      </label>
    
    <a href="./" title="Ansi handler" class="md-nav__link md-nav__link--active">
      Ansi handler
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_ansi_string" class="md-nav__link">
    get_ansi_string
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansicolor" class="md-nav__link">
    AnsiColor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#console_screen_buffer_info" class="md-nav__link">
    CONSOLE_SCREEN_BUFFER_INFO
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_1" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coloredformatter" class="md-nav__link">
    ColoredFormatter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_1" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_2" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converter" class="md-nav__link">
    converter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format" class="md-nav__link">
    format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatexception" class="md-nav__link">
    formatException
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatmessage" class="md-nav__link">
    formatMessage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatstack" class="md-nav__link">
    formatStack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formattime" class="md-nav__link">
    formatTime
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usestime" class="md-nav__link">
    usesTime
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coloredstreamhandler" class="md-nav__link">
    ColoredStreamHandler
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_2" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_3" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acquire" class="md-nav__link">
    acquire
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addfilter" class="md-nav__link">
    addFilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call_win32" class="md-nav__link">
    call_win32
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#close" class="md-nav__link">
    close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert_ansi" class="md-nav__link">
    convert_ansi
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#createlock" class="md-nav__link">
    createLock
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#emit" class="md-nav__link">
    emit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract_params" class="md-nav__link">
    extract_params
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter" class="md-nav__link">
    filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flush" class="md-nav__link">
    flush
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format_1" class="md-nav__link">
    format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_attrs" class="md-nav__link">
    get_attrs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_name" class="md-nav__link">
    get_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_win32_calls" class="md-nav__link">
    get_win32_calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle" class="md-nav__link">
    handle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handleerror" class="md-nav__link">
    handleError
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#release" class="md-nav__link">
    release
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removefilter" class="md-nav__link">
    removeFilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setformatter" class="md-nav__link">
    setFormatter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setlevel" class="md-nav__link">
    setLevel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setstream" class="md-nav__link">
    setStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_attrs" class="md-nav__link">
    set_attrs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_background" class="md-nav__link">
    set_background
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_console" class="md-nav__link">
    set_console
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_foreground" class="md-nav__link">
    set_foreground
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_name" class="md-nav__link">
    set_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write" class="md-nav__link">
    write
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_and_convert" class="md-nav__link">
    write_and_convert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_plain_text" class="md-nav__link">
    write_plain_text
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#win32console" class="md-nav__link">
    Win32Console
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-variables_4" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getconsolescreenbufferinfo" class="md-nav__link">
    GetConsoleScreenBufferInfo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setconsoletextattribute" class="md-nav__link">
    SetConsoleTextAttribute
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#winapi_test" class="md-nav__link">
    winapi_test
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wincolor" class="md-nav__link">
    WinColor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-variables_5" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../file_handler/" title="File handler" class="md-nav__link">
      File handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../junit_report_format/" title="Junit report format" class="md-nav__link">
      Junit report format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../markdown_handler/" title="Markdown handler" class="md-nav__link">
      Markdown handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../string_handler/" title="String handler" class="md-nav__link">
      String handler
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-7" type="checkbox" id="nav-11-7">
    
    <label class="md-nav__link" for="nav-11-7">
      Tpm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-7">
        Tpm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tpm/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tpm/tpm2_defs/" title="Tpm2 defs" class="md-nav__link">
      Tpm2 defs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tpm/tpm2_policy_calc/" title="Tpm2 policy calc" class="md-nav__link">
      Tpm2 policy calc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tpm/tpm2_simulator/" title="Tpm2 simulator" class="md-nav__link">
      Tpm2 simulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tpm/tpm2_stream/" title="Tpm2 stream" class="md-nav__link">
      Tpm2 stream
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-8" type="checkbox" id="nav-11-8">
    
    <label class="md-nav__link" for="nav-11-8">
      Uefi
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-8">
        Uefi
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/authenticated_variables_structure_support/" title="Authenticated variables structure support" class="md-nav__link">
      Authenticated variables structure support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/bmp_object/" title="Bmp object" class="md-nav__link">
      Bmp object
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/fmp_auth_header/" title="Fmp auth header" class="md-nav__link">
      Fmp auth header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/fmp_capsule_header/" title="Fmp capsule header" class="md-nav__link">
      Fmp capsule header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/pi_firmware_file/" title="Pi firmware file" class="md-nav__link">
      Pi firmware file
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/pi_firmware_volume/" title="Pi firmware volume" class="md-nav__link">
      Pi firmware volume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/status_codes/" title="Status codes" class="md-nav__link">
      Status codes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/uefi_capsule_header/" title="Uefi capsule header" class="md-nav__link">
      Uefi capsule header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/uefi_multi_phase/" title="Uefi multi phase" class="md-nav__link">
      Uefi multi phase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/wincert/" title="Wincert" class="md-nav__link">
      Wincert
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-8-12" type="checkbox" id="nav-11-8-12">
    
    <label class="md-nav__link" for="nav-11-8-12">
      Edk2
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-11-8-12">
        Edk2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/fmp_payload_header/" title="Fmp payload header" class="md-nav__link">
      Fmp payload header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/ftw_working_block_format/" title="Ftw working block format" class="md-nav__link">
      Ftw working block format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/guid_list/" title="Guid list" class="md-nav__link">
      Guid list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/path_utilities/" title="Path utilities" class="md-nav__link">
      Path utilities
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/variablestore_manulipulations/" title="Variablestore manulipulations" class="md-nav__link">
      Variablestore manulipulations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/variable_format/" title="Variable format" class="md-nav__link">
      Variable format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-8-12-8" type="checkbox" id="nav-11-8-12-8">
    
    <label class="md-nav__link" for="nav-11-8-12-8">
      Build objects
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-11-8-12-8">
        Build objects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/build_objects/readme/" title="Readme" class="md-nav__link">
      Readme
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-8-12-9" type="checkbox" id="nav-11-8-12-9">
    
    <label class="md-nav__link" for="nav-11-8-12-9">
      Parsers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-11-8-12-9">
        Parsers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/base_parser/" title="Base parser" class="md-nav__link">
      Base parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/buildreport_parser/" title="Buildreport parser" class="md-nav__link">
      Buildreport parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/dec_parser/" title="Dec parser" class="md-nav__link">
      Dec parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/dsc_parser/" title="Dsc parser" class="md-nav__link">
      Dsc parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/fdf_parser/" title="Fdf parser" class="md-nav__link">
      Fdf parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/guid_parser/" title="Guid parser" class="md-nav__link">
      Guid parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/inf_parser/" title="Inf parser" class="md-nav__link">
      Inf parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/override_parser/" title="Override parser" class="md-nav__link">
      Override parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../uefi/edk2/parsers/targettxt_parser/" title="Targettxt parser" class="md-nav__link">
      Targettxt parser
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-9" type="checkbox" id="nav-11-9">
    
    <label class="md-nav__link" for="nav-11-9">
      Windows
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-9">
        Windows
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/locate_tools/" title="Locate tools" class="md-nav__link">
      Locate tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-9-3" type="checkbox" id="nav-11-9-3">
    
    <label class="md-nav__link" for="nav-11-9-3">
      Capsule
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-11-9-3">
        Capsule
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/capsule/cat_generator/" title="Cat generator" class="md-nav__link">
      Cat generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/capsule/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/capsule/inf_generator/" title="Inf generator" class="md-nav__link">
      Inf generator
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_ansi_string" class="md-nav__link">
    get_ansi_string
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansicolor" class="md-nav__link">
    AnsiColor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#console_screen_buffer_info" class="md-nav__link">
    CONSOLE_SCREEN_BUFFER_INFO
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_1" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coloredformatter" class="md-nav__link">
    ColoredFormatter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_1" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_2" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converter" class="md-nav__link">
    converter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format" class="md-nav__link">
    format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatexception" class="md-nav__link">
    formatException
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatmessage" class="md-nav__link">
    formatMessage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatstack" class="md-nav__link">
    formatStack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formattime" class="md-nav__link">
    formatTime
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usestime" class="md-nav__link">
    usesTime
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coloredstreamhandler" class="md-nav__link">
    ColoredStreamHandler
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_2" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_3" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acquire" class="md-nav__link">
    acquire
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addfilter" class="md-nav__link">
    addFilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call_win32" class="md-nav__link">
    call_win32
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#close" class="md-nav__link">
    close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert_ansi" class="md-nav__link">
    convert_ansi
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#createlock" class="md-nav__link">
    createLock
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#emit" class="md-nav__link">
    emit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract_params" class="md-nav__link">
    extract_params
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter" class="md-nav__link">
    filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flush" class="md-nav__link">
    flush
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format_1" class="md-nav__link">
    format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_attrs" class="md-nav__link">
    get_attrs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_name" class="md-nav__link">
    get_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_win32_calls" class="md-nav__link">
    get_win32_calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle" class="md-nav__link">
    handle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handleerror" class="md-nav__link">
    handleError
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#release" class="md-nav__link">
    release
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removefilter" class="md-nav__link">
    removeFilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setformatter" class="md-nav__link">
    setFormatter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setlevel" class="md-nav__link">
    setLevel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setstream" class="md-nav__link">
    setStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_attrs" class="md-nav__link">
    set_attrs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_background" class="md-nav__link">
    set_background
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_console" class="md-nav__link">
    set_console
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_foreground" class="md-nav__link">
    set_foreground
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_name" class="md-nav__link">
    set_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write" class="md-nav__link">
    write
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_and_convert" class="md-nav__link">
    write_and_convert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_plain_text" class="md-nav__link">
    write_plain_text
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#win32console" class="md-nav__link">
    Win32Console
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-variables_4" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getconsolescreenbufferinfo" class="md-nav__link">
    GetConsoleScreenBufferInfo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setconsoletextattribute" class="md-nav__link">
    SetConsoleTextAttribute
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#winapi_test" class="md-nav__link">
    winapi_test
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wincolor" class="md-nav__link">
    WinColor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-variables_5" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/matthewfcarlson/edk2-pytool-library/edit/master/docs/edk2toollib/log/ansi_handler.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="module-edk2toolliblogansi_handler">Module edk2toollib.log.ansi_handler</h1>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="c1">##</span>

<span class="c1"># Handle basic logging with color via ANSI commands</span>

<span class="c1"># Will call into win32 commands as needed when needed</span>

<span class="c1">#</span>

<span class="c1"># Copyright (c) Microsoft Corporation</span>

<span class="c1">#</span>

<span class="c1"># SPDX-License-Identifier: BSD-2-Clause-Patent</span>

<span class="c1">##</span>

<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">edk2toollib.utility_functions</span> <span class="kn">import</span> <span class="n">GetHostInfo</span>

<span class="k">try</span><span class="p">:</span>

    <span class="c1"># try to import windows types from winDLL</span>

    <span class="kn">import</span> <span class="nn">ctypes</span>

    <span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">LibraryLoader</span>

    <span class="n">windll</span> <span class="o">=</span> <span class="n">LibraryLoader</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">WinDLL</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">wintypes</span>

<span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ImportError</span><span class="p">):</span>

    <span class="c1"># if we run into an exception (ie on unix or linux)</span>

    <span class="n">windll</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1"># create blank lambda</span>

    <span class="k">def</span> <span class="nf">SetConsoleTextAttribute</span><span class="p">():</span>

        <span class="bp">None</span>

    <span class="c1"># create blank lambda</span>

    <span class="k">def</span> <span class="nf">winapi_test</span><span class="p">():</span>

        <span class="bp">None</span>

<span class="k">else</span><span class="p">:</span>

    <span class="c1"># if we don&#39;t raise an exception when we import windows types</span>

    <span class="c1"># then execute this but don&#39;t catch an exception if raised</span>

    <span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">byref</span><span class="p">,</span> <span class="n">Structure</span>

    <span class="c1"># inspired by https://github.com/tartley/colorama/</span>

    <span class="k">class</span> <span class="nc">CONSOLE_SCREEN_BUFFER_INFO</span><span class="p">(</span><span class="n">Structure</span><span class="p">):</span>

        <span class="n">COORD</span> <span class="o">=</span> <span class="n">wintypes</span><span class="o">.</span><span class="n">_COORD</span>

        <span class="sd">&quot;&quot;&quot;struct in wincon.h.&quot;&quot;&quot;</span>

        <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[</span>

            <span class="p">(</span><span class="s2">&quot;dwSize&quot;</span><span class="p">,</span> <span class="n">COORD</span><span class="p">),</span>

            <span class="p">(</span><span class="s2">&quot;dwCursorPosition&quot;</span><span class="p">,</span> <span class="n">COORD</span><span class="p">),</span>

            <span class="p">(</span><span class="s2">&quot;wAttributes&quot;</span><span class="p">,</span> <span class="n">wintypes</span><span class="o">.</span><span class="n">WORD</span><span class="p">),</span>

            <span class="p">(</span><span class="s2">&quot;srWindow&quot;</span><span class="p">,</span> <span class="n">wintypes</span><span class="o">.</span><span class="n">SMALL_RECT</span><span class="p">),</span>

            <span class="p">(</span><span class="s2">&quot;dwMaximumWindowSize&quot;</span><span class="p">,</span> <span class="n">COORD</span><span class="p">),</span>

        <span class="p">]</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

            <span class="k">return</span> <span class="s1">&#39;(</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">dwSize</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwSize</span><span class="o">.</span><span class="n">X</span><span class="p">,</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">dwCursorPosition</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwCursorPosition</span><span class="o">.</span><span class="n">X</span><span class="p">,</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">wAttributes</span><span class="p">,</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">srWindow</span><span class="o">.</span><span class="n">Top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">srWindow</span><span class="o">.</span><span class="n">Left</span><span class="p">,</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">srWindow</span><span class="o">.</span><span class="n">Bottom</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">srWindow</span><span class="o">.</span><span class="n">Right</span><span class="p">,</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">dwMaximumWindowSize</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwMaximumWindowSize</span><span class="o">.</span><span class="n">X</span>

            <span class="p">)</span>

    <span class="c1"># a simple wrapper around the few methods calls to windows</span>

    <span class="k">class</span> <span class="nc">Win32Console</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

        <span class="n">_GetConsoleScreenBufferInfo</span> <span class="o">=</span> <span class="n">windll</span><span class="o">.</span><span class="n">kernel32</span><span class="o">.</span><span class="n">GetConsoleScreenBufferInfo</span>

        <span class="n">_SetConsoleTextAttribute</span> <span class="o">=</span> <span class="n">windll</span><span class="o">.</span><span class="n">kernel32</span><span class="o">.</span><span class="n">SetConsoleTextAttribute</span>

        <span class="n">_SetConsoleTextAttribute</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>

            <span class="n">wintypes</span><span class="o">.</span><span class="n">HANDLE</span><span class="p">,</span>

            <span class="n">wintypes</span><span class="o">.</span><span class="n">WORD</span><span class="p">,</span>

        <span class="p">]</span>

        <span class="n">_SetConsoleTextAttribute</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">wintypes</span><span class="o">.</span><span class="n">BOOL</span>

        <span class="n">_GetStdHandle</span> <span class="o">=</span> <span class="n">windll</span><span class="o">.</span><span class="n">kernel32</span><span class="o">.</span><span class="n">GetStdHandle</span>

        <span class="n">_GetStdHandle</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>

            <span class="n">wintypes</span><span class="o">.</span><span class="n">DWORD</span><span class="p">,</span>

        <span class="p">]</span>

        <span class="n">_GetStdHandle</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">wintypes</span><span class="o">.</span><span class="n">HANDLE</span>

        <span class="c1"># from winbase.h</span>

        <span class="n">STDOUT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">11</span>

        <span class="n">STDERR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>

        <span class="nd">@staticmethod</span>

        <span class="k">def</span> <span class="nf">_winapi_test</span><span class="p">(</span><span class="n">handle</span><span class="p">):</span>

            <span class="n">csbi</span> <span class="o">=</span> <span class="n">CONSOLE_SCREEN_BUFFER_INFO</span><span class="p">()</span>

            <span class="n">success</span> <span class="o">=</span> <span class="n">Win32Console</span><span class="o">.</span><span class="n">_GetConsoleScreenBufferInfo</span><span class="p">(</span>

                <span class="n">handle</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">csbi</span><span class="p">))</span>

            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>

        <span class="nd">@staticmethod</span>

        <span class="k">def</span> <span class="nf">winapi_test</span><span class="p">():</span>

            <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">Win32Console</span><span class="o">.</span><span class="n">_winapi_test</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span>

                       <span class="p">(</span><span class="n">Win32Console</span><span class="o">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">Win32Console</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">),</span>

                        <span class="n">Win32Console</span><span class="o">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">Win32Console</span><span class="o">.</span><span class="n">STDERR</span><span class="p">)))</span>

        <span class="nd">@staticmethod</span>

        <span class="k">def</span> <span class="nf">GetConsoleScreenBufferInfo</span><span class="p">(</span><span class="n">stream_id</span><span class="o">=</span><span class="n">STDOUT</span><span class="p">):</span>

            <span class="n">handle</span> <span class="o">=</span> <span class="n">Win32Console</span><span class="o">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">stream_id</span><span class="p">)</span>

            <span class="n">csbi</span> <span class="o">=</span> <span class="n">CONSOLE_SCREEN_BUFFER_INFO</span><span class="p">()</span>

            <span class="n">Win32Console</span><span class="o">.</span><span class="n">_GetConsoleScreenBufferInfo</span><span class="p">(</span>

                <span class="n">handle</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">csbi</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">csbi</span>

        <span class="nd">@staticmethod</span>

        <span class="k">def</span> <span class="nf">SetConsoleTextAttribute</span><span class="p">(</span><span class="n">stream_id</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>

            <span class="n">handle</span> <span class="o">=</span> <span class="n">Win32Console</span><span class="o">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">stream_id</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">Win32Console</span><span class="o">.</span><span class="n">_SetConsoleTextAttribute</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>

<span class="c1"># from wincon.h</span>

<span class="k">class</span> <span class="nc">WinColor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">BLACK</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">BLUE</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">GREEN</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="n">CYAN</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">RED</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="n">MAGENTA</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="n">YELLOW</span> <span class="o">=</span> <span class="mi">6</span>

    <span class="n">GREY</span> <span class="o">=</span> <span class="mi">7</span>

    <span class="n">NORMAL</span> <span class="o">=</span> <span class="mh">0x00</span>  <span class="c1"># dim text, dim background</span>

    <span class="n">BRIGHT</span> <span class="o">=</span> <span class="mh">0x08</span>  <span class="c1"># bright text, dim background</span>

    <span class="n">BRIGHT_BACKGROUND</span> <span class="o">=</span> <span class="mh">0x80</span>  <span class="c1"># dim text, bright background</span>

<span class="c1"># defines the different codes for the ansi colors</span>

<span class="k">class</span> <span class="nc">AnsiColor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">BLACK</span> <span class="o">=</span> <span class="mi">30</span>

    <span class="n">RED</span> <span class="o">=</span> <span class="mi">31</span>

    <span class="n">GREEN</span> <span class="o">=</span> <span class="mi">32</span>

    <span class="n">YELLOW</span> <span class="o">=</span> <span class="mi">33</span>

    <span class="n">BLUE</span> <span class="o">=</span> <span class="mi">34</span>

    <span class="n">MAGENTA</span> <span class="o">=</span> <span class="mi">35</span>

    <span class="n">CYAN</span> <span class="o">=</span> <span class="mi">36</span>

    <span class="n">WHITE</span> <span class="o">=</span> <span class="mi">37</span>

    <span class="n">RESET</span> <span class="o">=</span> <span class="mi">39</span>

    <span class="n">LIGHTBLACK_EX</span> <span class="o">=</span> <span class="mi">90</span>

    <span class="n">LIGHTRED_EX</span> <span class="o">=</span> <span class="mi">91</span>

    <span class="n">LIGHTGREEN_EX</span> <span class="o">=</span> <span class="mi">92</span>

    <span class="n">LIGHTYELLOW_EX</span> <span class="o">=</span> <span class="mi">93</span>

    <span class="n">LIGHTBLUE_EX</span> <span class="o">=</span> <span class="mi">94</span>

    <span class="n">LIGHTMAGENTA_EX</span> <span class="o">=</span> <span class="mi">95</span>

    <span class="n">LIGHTCYAN_EX</span> <span class="o">=</span> <span class="mi">96</span>

    <span class="n">LIGHTWHITE_EX</span> <span class="o">=</span> <span class="mi">97</span>

    <span class="n">BG_BLACK</span> <span class="o">=</span> <span class="mi">40</span>

    <span class="n">BG_RED</span> <span class="o">=</span> <span class="mi">41</span>

    <span class="n">BG_GREEN</span> <span class="o">=</span> <span class="mi">42</span>

    <span class="n">BG_YELLOW</span> <span class="o">=</span> <span class="mi">43</span>

    <span class="n">BG_BLUE</span> <span class="o">=</span> <span class="mi">44</span>

    <span class="n">BG_MAGENTA</span> <span class="o">=</span> <span class="mi">45</span>

    <span class="n">BG_CYAN</span> <span class="o">=</span> <span class="mi">46</span>

    <span class="n">BG_WHITE</span> <span class="o">=</span> <span class="mi">47</span>

    <span class="n">BG_RESET</span> <span class="o">=</span> <span class="mi">49</span>

    <span class="c1"># These are fairly well supported, but not part of the standard.</span>

    <span class="n">BG_LIGHTBLACK_EX</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="n">BG_LIGHTRED_EX</span> <span class="o">=</span> <span class="mi">101</span>

    <span class="n">BG_LIGHTGREEN_EX</span> <span class="o">=</span> <span class="mi">102</span>

    <span class="n">BG_LIGHTYELLOW_EX</span> <span class="o">=</span> <span class="mi">103</span>

    <span class="n">BG_LIGHTBLUE_EX</span> <span class="o">=</span> <span class="mi">104</span>

    <span class="n">BG_LIGHTMAGENTA_EX</span> <span class="o">=</span> <span class="mi">105</span>

    <span class="n">BG_LIGHTCYAN_EX</span> <span class="o">=</span> <span class="mi">106</span>

    <span class="n">BG_LIGHTWHITE_EX</span> <span class="o">=</span> <span class="mi">107</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>

            <span class="k">return</span> <span class="bp">True</span>

        <span class="c1"># check if we contain the color number</span>

        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span> <span class="ow">is</span> <span class="n">item</span><span class="p">:</span>

                <span class="k">return</span> <span class="bp">True</span>

        <span class="k">return</span> <span class="bp">False</span>

<span class="c1"># the formatter that outputs ANSI codes as needed</span>

<span class="k">class</span> <span class="nc">ColoredFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">):</span>

    <span class="n">AZURE_COLORS</span> <span class="o">=</span> <span class="p">{</span>

        <span class="s1">&#39;CRITICAL&#39;</span><span class="p">:</span> <span class="s2">&quot;section&quot;</span><span class="p">,</span>

        <span class="s1">&#39;ERROR&#39;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span>

    <span class="p">}</span>

    <span class="n">COLORS</span> <span class="o">=</span> <span class="p">{</span>

        <span class="s1">&#39;WARNING&#39;</span><span class="p">:</span> <span class="n">AnsiColor</span><span class="o">.</span><span class="n">YELLOW</span><span class="p">,</span>

        <span class="s1">&#39;INFO&#39;</span><span class="p">:</span> <span class="n">AnsiColor</span><span class="o">.</span><span class="n">CYAN</span><span class="p">,</span>

        <span class="s1">&#39;DEBUG&#39;</span><span class="p">:</span> <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BLUE</span><span class="p">,</span>

        <span class="s1">&#39;CRITICAL&#39;</span><span class="p">:</span> <span class="n">AnsiColor</span><span class="o">.</span><span class="n">LIGHTWHITE_EX</span><span class="p">,</span>

        <span class="s1">&#39;ERROR&#39;</span><span class="p">:</span> <span class="n">AnsiColor</span><span class="o">.</span><span class="n">RED</span><span class="p">,</span>

        <span class="s2">&quot;STATUS&quot;</span><span class="p">:</span> <span class="n">AnsiColor</span><span class="o">.</span><span class="n">GREEN</span><span class="p">,</span>

        <span class="s2">&quot;PROGRESS&quot;</span><span class="p">:</span> <span class="n">AnsiColor</span><span class="o">.</span><span class="n">GREEN</span><span class="p">,</span>

        <span class="s2">&quot;SECTION&quot;</span><span class="p">:</span> <span class="n">AnsiColor</span><span class="o">.</span><span class="n">CYAN</span>

    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">use_azure</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_azure</span> <span class="o">=</span> <span class="n">use_azure</span>

    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>

        <span class="n">levelname</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">levelname</span>

        <span class="n">org_message</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">msg</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_azure</span> <span class="ow">and</span> <span class="n">levelname</span> <span class="ow">in</span> <span class="n">ColoredFormatter</span><span class="o">.</span><span class="n">COLORS</span><span class="p">:</span>

            <span class="c1"># just color the level name</span>

            <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">levelno</span> <span class="o">&lt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">:</span>

                <span class="n">levelname_color</span> <span class="o">=</span> <span class="n">get_ansi_string</span><span class="p">(</span><span class="n">ColoredFormatter</span><span class="o">.</span><span class="n">COLORS</span><span class="p">[</span><span class="n">levelname</span><span class="p">])</span> <span class="o">+</span> <span class="n">levelname</span> <span class="o">+</span> <span class="n">get_ansi_string</span><span class="p">()</span>

            <span class="c1"># otherwise color the wholes message</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">levelname_color</span> <span class="o">=</span> <span class="n">get_ansi_string</span><span class="p">(</span><span class="n">ColoredFormatter</span><span class="o">.</span><span class="n">COLORS</span><span class="p">[</span><span class="n">levelname</span><span class="p">])</span> <span class="o">+</span> <span class="n">levelname</span>

                <span class="n">record</span><span class="o">.</span><span class="n">msg</span> <span class="o">+=</span> <span class="n">get_ansi_string</span><span class="p">()</span>

            <span class="n">record</span><span class="o">.</span><span class="n">levelname</span> <span class="o">=</span> <span class="n">levelname_color</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_azure</span> <span class="ow">and</span> <span class="n">levelname</span> <span class="ow">in</span> <span class="n">ColoredFormatter</span><span class="o">.</span><span class="n">AZURE_COLORS</span><span class="p">:</span>

            <span class="n">levelname_color</span> <span class="o">=</span> <span class="s2">&quot;##[&quot;</span> <span class="o">+</span> \

                <span class="n">ColoredFormatter</span><span class="o">.</span><span class="n">AZURE_COLORS</span><span class="p">[</span><span class="n">levelname</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>

            <span class="n">record</span><span class="o">.</span><span class="n">levelname</span> <span class="o">=</span> <span class="n">levelname_color</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">)</span>

        <span class="n">record</span><span class="o">.</span><span class="n">levelname</span> <span class="o">=</span> <span class="n">levelname</span>

        <span class="n">record</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">org_message</span>

        <span class="k">return</span> <span class="n">result</span>

<span class="c1"># returns the string formatted ANSI command for the specific color</span>

<span class="k">def</span> <span class="nf">get_ansi_string</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">AnsiColor</span><span class="o">.</span><span class="n">RESET</span><span class="p">):</span>

    <span class="n">CSI</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[&#39;</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="n">AnsiColor</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">color</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>

        <span class="n">color</span> <span class="o">=</span> <span class="n">AnsiColor</span><span class="o">.</span><span class="n">RESET</span>

    <span class="k">return</span> <span class="n">CSI</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;m&#39;</span>

<span class="k">class</span> <span class="nc">ColoredStreamHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">):</span>

    <span class="c1"># Control Sequence Introducer</span>

    <span class="n">ANSI_CSI_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\001</span><span class="s1">?</span><span class="se">\033\\</span><span class="s1">[((?:</span><span class="se">\\</span><span class="s1">d|;)*)([a-zA-Z])</span><span class="se">\002</span><span class="s1">?&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">strip</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">on_windows</span> <span class="o">=</span> <span class="n">GetHostInfo</span><span class="p">()</span><span class="o">.</span><span class="n">os</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span>

        <span class="c1"># We test if the WinAPI works, because even if we are on Windows</span>

        <span class="c1"># we may be using a terminal that doesn&#39;t support the WinAPI</span>

        <span class="c1"># (e.g. Cygwin Terminal). In this case it&#39;s up to the terminal</span>

        <span class="c1"># to support the ANSI codes.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">conversion_supported</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_windows</span> <span class="ow">and</span> <span class="n">Win32Console</span><span class="o">.</span><span class="n">winapi_test</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">strip</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c1"># should we strip ANSI sequences from our output?</span>

        <span class="k">if</span> <span class="n">strip</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

            <span class="n">strip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conversion_supported</span> <span class="ow">or</span> <span class="p">(</span>

                <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">closed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">isatty</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">strip</span> <span class="o">=</span> <span class="n">strip</span>

        <span class="c1"># should we should convert ANSI sequences into win32 calls?</span>

        <span class="k">if</span> <span class="n">convert</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

            <span class="n">convert</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conversion_supported</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">closed</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">isatty</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">convert</span> <span class="o">=</span> <span class="n">convert</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">win32_calls</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="n">stream</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_windows</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">win32_calls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_win32_calls</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_light</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_default</span> <span class="o">=</span> <span class="n">Win32Console</span><span class="o">.</span><span class="n">GetConsoleScreenBufferInfo</span><span class="p">(</span>

                <span class="n">Win32Console</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span><span class="o">.</span><span class="n">wAttributes</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_attrs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_default_fore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fore</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_default_back</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_back</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_default_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_style</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Conditionally emit the specified logging record.</span>

<span class="sd">        Emission depends on filters which may have been added to the handler.</span>

<span class="sd">        Wrap the actual emission of the record with acquisition/release of</span>

<span class="sd">        the I/O thread lock. Returns whether the filter passed the record for</span>

<span class="sd">        emission.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rv</span> <span class="ow">and</span> <span class="n">record</span><span class="o">.</span><span class="n">levelno</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

            <span class="k">finally</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">rv</span>

    <span class="k">def</span> <span class="nf">get_win32_calls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">:</span>

            <span class="k">return</span> <span class="p">{</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BLACK</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BLACK</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">RED</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">RED</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">GREEN</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">GREEN</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">YELLOW</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">YELLOW</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BLUE</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BLUE</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">MAGENTA</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">MAGENTA</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">CYAN</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">CYAN</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">WHITE</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">GREY</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">RESET</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">LIGHTBLACK_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BLACK</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">LIGHTRED_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">RED</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">LIGHTGREEN_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">GREEN</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">LIGHTYELLOW_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">YELLOW</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">LIGHTBLUE_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BLUE</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">LIGHTMAGENTA_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">MAGENTA</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">LIGHTCYAN_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">CYAN</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">LIGHTWHITE_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">GREY</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_BLACK</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BLACK</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_RED</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">RED</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_GREEN</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">GREEN</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_YELLOW</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">YELLOW</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_BLUE</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BLUE</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_MAGENTA</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">MAGENTA</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_CYAN</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">CYAN</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_WHITE</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">GREY</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_RESET</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_LIGHTBLACK_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BLACK</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_LIGHTRED_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">RED</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_LIGHTGREEN_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">GREEN</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_LIGHTYELLOW_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">YELLOW</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_LIGHTBLUE_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BLUE</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_LIGHTMAGENTA_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">MAGENTA</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_LIGHTCYAN_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">CYAN</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="o">.</span><span class="n">BG_LIGHTWHITE_EX</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">GREY</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>

            <span class="p">}</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="c1"># does the win32 call to set the foreground</span>

    <span class="k">def</span> <span class="nf">set_foreground</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fore</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">on_stderr</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">fore</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

            <span class="n">fore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_fore</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fore</span> <span class="o">=</span> <span class="n">fore</span>

        <span class="c1"># Emulate LIGHT_EX with BRIGHT Style</span>

        <span class="k">if</span> <span class="n">light</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_light</span> <span class="o">|=</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BRIGHT</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_light</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">WinColor</span><span class="o">.</span><span class="n">BRIGHT</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_console</span><span class="p">(</span><span class="n">on_stderr</span><span class="o">=</span><span class="n">on_stderr</span><span class="p">)</span>

    <span class="c1"># does the win32 call to see the background</span>

    <span class="k">def</span> <span class="nf">set_background</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">on_stderr</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">back</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

            <span class="n">back</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_back</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_back</span> <span class="o">=</span> <span class="n">back</span>

        <span class="c1"># Emulate LIGHT_EX with BRIGHT_BACKGROUND Style</span>

        <span class="k">if</span> <span class="n">light</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_light</span> <span class="o">|=</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BRIGHT_BACKGROUND</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_light</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">WinColor</span><span class="o">.</span><span class="n">BRIGHT_BACKGROUND</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_console</span><span class="p">(</span><span class="n">on_stderr</span><span class="o">=</span><span class="n">on_stderr</span><span class="p">)</span>

    <span class="c1"># the win32 call to set the console text attribute</span>

    <span class="k">def</span> <span class="nf">set_console</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">on_stderr</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">attrs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

            <span class="n">attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attrs</span><span class="p">()</span>

        <span class="n">handle</span> <span class="o">=</span> <span class="n">Win32Console</span><span class="o">.</span><span class="n">STDOUT</span>

        <span class="k">if</span> <span class="n">on_stderr</span><span class="p">:</span>

            <span class="n">handle</span> <span class="o">=</span> <span class="n">Win32Console</span><span class="o">.</span><span class="n">STDERR</span>

        <span class="n">Win32Console</span><span class="o">.</span><span class="n">SetConsoleTextAttribute</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>

    <span class="c1"># gets the current settings for the style and colors selected</span>

    <span class="k">def</span> <span class="nf">get_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fore</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_back</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_style</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">_light</span><span class="p">)</span>

    <span class="c1"># sets the attributes for the style and colors selected</span>

    <span class="k">def</span> <span class="nf">set_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fore</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="mi">7</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_back</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_style</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">WinColor</span><span class="o">.</span><span class="n">BRIGHT</span> <span class="o">|</span> <span class="n">WinColor</span><span class="o">.</span><span class="n">BRIGHT_BACKGROUND</span><span class="p">)</span>

    <span class="c1"># writes to stream, stripping ANSI if specified</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write_and_convert</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write_plain_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="c1"># write the given text to the strip stripping and converting ANSI</span>

    <span class="k">def</span> <span class="nf">write_and_convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>

        <span class="n">cursor</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ANSI_CSI_RE</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>

            <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">span</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">cursor</span> <span class="o">&lt;</span> <span class="n">start</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">write_plain_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">convert_ansi</span><span class="p">(</span><span class="o">*</span><span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>

            <span class="n">cursor</span> <span class="o">=</span> <span class="n">end</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write_plain_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>

    <span class="c1"># writes plain text to our stream</span>

    <span class="k">def</span> <span class="nf">write_plain_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="c1"># converts an ANSI command to a win32 command</span>

    <span class="k">def</span> <span class="nf">convert_ansi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paramstring</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">:</span>

            <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_params</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">paramstring</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">call_win32</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="c1"># extracts the parameters in the ANSI command</span>

    <span class="k">def</span> <span class="nf">extract_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">paramstring</span><span class="p">):</span>

        <span class="n">params</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paramstring</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,)</span>

        <span class="k">return</span> <span class="n">params</span>

    <span class="c1"># calls the win32 apis set_foreground and set_background</span>

    <span class="k">def</span> <span class="nf">call_win32</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">win32_calls</span><span class="p">:</span>

                    <span class="n">func_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">win32_calls</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>

                    <span class="n">func</span> <span class="o">=</span> <span class="n">func_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">args</span> <span class="o">=</span> <span class="n">func_args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

                    <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

                    <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># logging.handler method we are overriding to emit a record</span>

    <span class="k">def</span> <span class="nf">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">record</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

                <span class="k">return</span>

            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">msg</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">terminator</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">handleError</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</code></pre></div>


</details>
<h2 id="functions">Functions</h2>
<h4 id="get_ansi_string">get_ansi_string</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_ansi_string</span><span class="p">(</span>
    <span class="n">color</span><span class="o">=</span><span class="mi">39</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">get_ansi_string</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">AnsiColor</span><span class="p">.</span><span class="k">RESET</span><span class="p">):</span>

    <span class="n">CSI</span> <span class="o">=</span> <span class="s1">&#39;\033[&#39;</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="n">AnsiColor</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">color</span> <span class="k">not</span> <span class="k">in</span> <span class="n">colors</span><span class="p">:</span>

        <span class="n">color</span> <span class="o">=</span> <span class="n">AnsiColor</span><span class="p">.</span><span class="k">RESET</span>

    <span class="k">return</span> <span class="n">CSI</span> <span class="o">+</span> <span class="n">str</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;m&#39;</span>
</code></pre></div>


</details>
<h2 id="classes">Classes</h2>
<h3 id="ansicolor">AnsiColor</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">AnsiColor</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">AnsiColor</span><span class="p">(</span><span class="k">object</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="n">BLACK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="w"></span>

<span class="w">    </span><span class="n">RED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">31</span><span class="w"></span>

<span class="w">    </span><span class="n">GREEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="w"></span>

<span class="w">    </span><span class="n">YELLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">33</span><span class="w"></span>

<span class="w">    </span><span class="n">BLUE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">34</span><span class="w"></span>

<span class="w">    </span><span class="n">MAGENTA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">35</span><span class="w"></span>

<span class="w">    </span><span class="n">CYAN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">36</span><span class="w"></span>

<span class="w">    </span><span class="n">WHITE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">37</span><span class="w"></span>

<span class="w">    </span><span class="n">RESET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">39</span><span class="w"></span>

<span class="w">    </span><span class="n">LIGHTBLACK_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">90</span><span class="w"></span>

<span class="w">    </span><span class="n">LIGHTRED_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">91</span><span class="w"></span>

<span class="w">    </span><span class="n">LIGHTGREEN_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">92</span><span class="w"></span>

<span class="w">    </span><span class="n">LIGHTYELLOW_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">93</span><span class="w"></span>

<span class="w">    </span><span class="n">LIGHTBLUE_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">94</span><span class="w"></span>

<span class="w">    </span><span class="n">LIGHTMAGENTA_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">95</span><span class="w"></span>

<span class="w">    </span><span class="n">LIGHTCYAN_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">96</span><span class="w"></span>

<span class="w">    </span><span class="n">LIGHTWHITE_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">97</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_BLACK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">40</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_RED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">41</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_GREEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_YELLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">43</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_BLUE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">44</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_MAGENTA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">45</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_CYAN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">46</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_WHITE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">47</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_RESET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">49</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">fairly</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="n">supported</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_LIGHTBLACK_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_LIGHTRED_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">101</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_LIGHTGREEN_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">102</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_LIGHTYELLOW_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">103</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_LIGHTBLUE_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">104</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_LIGHTMAGENTA_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">105</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_LIGHTCYAN_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">106</span><span class="w"></span>

<span class="w">    </span><span class="n">BG_LIGHTWHITE_EX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">107</span><span class="w"></span>

<span class="w">    </span><span class="nv">@classmethod</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__contains__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nf">str</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hasattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="n">number</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">attr_name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">dir</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nl">item</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>
</code></pre></div>


</details>
<hr />
<h4 id="class-variables">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">BG_BLACK</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_BLUE</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_CYAN</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_GREEN</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_LIGHTBLACK_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_LIGHTBLUE_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_LIGHTCYAN_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_LIGHTGREEN_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_LIGHTMAGENTA_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_LIGHTRED_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_LIGHTWHITE_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_LIGHTYELLOW_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_MAGENTA</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_RED</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_RESET</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_WHITE</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BG_YELLOW</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BLACK</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BLUE</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">CYAN</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">GREEN</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">LIGHTBLACK_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">LIGHTBLUE_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">LIGHTCYAN_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">LIGHTGREEN_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">LIGHTMAGENTA_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">LIGHTRED_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">LIGHTWHITE_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">LIGHTYELLOW_EX</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">MAGENTA</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">RED</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">RESET</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">WHITE</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">YELLOW</span>
</code></pre></div>


<h3 id="console_screen_buffer_info">CONSOLE_SCREEN_BUFFER_INFO</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">CONSOLE_SCREEN_BUFFER_INFO</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>


<p>Structure base class</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="k">class</span> <span class="n">CONSOLE_SCREEN_BUFFER_INFO</span>(<span class="n">Structure</span>):

        <span class="n">COORD</span> = <span class="n">wintypes</span>.<span class="n">_COORD</span>

        <span class="s">&quot;&quot;&quot;struct in wincon.h.&quot;&quot;&quot;</span>

        <span class="n">_fields_</span> = [

            (<span class="s">&quot;dwSize&quot;</span>, <span class="n">COORD</span>),

            (<span class="s">&quot;dwCursorPosition&quot;</span>, <span class="n">COORD</span>),

            (<span class="s">&quot;wAttributes&quot;</span>, <span class="n">wintypes</span>.<span class="n">WORD</span>),

            (<span class="s">&quot;srWindow&quot;</span>, <span class="n">wintypes</span>.<span class="n">SMALL_RECT</span>),

            (<span class="s">&quot;dwMaximumWindowSize&quot;</span>, <span class="n">COORD</span>),

        ]

        <span class="n">def</span> <span class="n">__str__</span>(<span class="nb">self</span>):

            <span class="k">return</span> <span class="s">&#39;(%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d)&#39;</span> % (

                <span class="nb">self</span>.<span class="n">dwSize</span>.<span class="n">Y</span>, <span class="nb">self</span>.<span class="n">dwSize</span>.<span class="o">X</span>,

                <span class="nb">self</span>.<span class="n">dwCursorPosition</span>.<span class="n">Y</span>, <span class="nb">self</span>.<span class="n">dwCursorPosition</span>.<span class="o">X</span>,

                <span class="nb">self</span>.<span class="n">wAttributes</span>,

                <span class="nb">self</span>.<span class="n">srWindow</span>.<span class="n">Top</span>, <span class="nb">self</span>.<span class="n">srWindow</span>.<span class="n">Left</span>,

                <span class="nb">self</span>.<span class="n">srWindow</span>.<span class="n">Bottom</span>, <span class="nb">self</span>.<span class="n">srWindow</span>.<span class="n">Right</span>,

                <span class="nb">self</span>.<span class="n">dwMaximumWindowSize</span>.<span class="n">Y</span>, <span class="nb">self</span>.<span class="n">dwMaximumWindowSize</span>.<span class="o">X</span>

            )
</code></pre></div>


</details>
<hr />
<h4 id="ancestors-in-mro">Ancestors (in MRO)</h4>
<ul>
<li>_ctypes.Structure</li>
<li>_ctypes._CData</li>
</ul>
<h4 id="class-variables_1">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">COORD</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">dwCursorPosition</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">dwMaximumWindowSize</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">dwSize</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">srWindow</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">wAttributes</span>
</code></pre></div>


<h3 id="coloredformatter">ColoredFormatter</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ColoredFormatter</span><span class="p">(</span>
    <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">use_azure</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>


<p>Formatter instances are used to convert a LogRecord to text.</p>
<p>Formatters need to know how a LogRecord is constructed. They are
responsible for converting a LogRecord to (usually) a string which can
be interpreted by either a human or an external system. The base Formatter
allows a formatting string to be specified. If none is supplied, the
the style-dependent default value, &ldquo;%(message)s&rdquo;, &ldquo;{message}&rdquo;, or
&ldquo;${message}&rdquo;, is used.</p>
<p>The Formatter can be initialized with a format string which makes use of
knowledge of the LogRecord attributes - e.g. the default value mentioned
above makes use of the fact that the user&rsquo;s message and arguments are pre-
formatted into a LogRecord&rsquo;s message attribute. Currently, the useful
attributes in a LogRecord are described by:</p>
<p>%(name)s            Name of the logger (logging channel)
%(levelno)s         Numeric logging level for the message (DEBUG, INFO,
                    WARNING, ERROR, CRITICAL)
%(levelname)s       Text logging level for the message (&ldquo;DEBUG&rdquo;, &ldquo;INFO&rdquo;,
                    &ldquo;WARNING&rdquo;, &ldquo;ERROR&rdquo;, &ldquo;CRITICAL&rdquo;)
%(pathname)s        Full pathname of the source file where the logging
                    call was issued (if available)
%(filename)s        Filename portion of pathname
%(module)s          Module (name portion of filename)
%(lineno)d          Source line number where the logging call was issued
                    (if available)
%(funcName)s        Function name
%(created)f         Time when the LogRecord was created (time.time()
                    return value)
%(asctime)s         Textual time when the LogRecord was created
%(msecs)d           Millisecond portion of the creation time
%(relativeCreated)d Time in milliseconds when the LogRecord was created,
                    relative to the time the logging module was loaded
                    (typically at application startup time)
%(thread)d          Thread ID (if available)
%(threadName)s      Thread name (if available)
%(process)d         Process ID (if available)
%(message)s         The result of record.getMessage(), computed just as
                    the record is emitted</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">ColoredFormatter</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">Formatter</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="n">AZURE_COLORS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"></span>

<span class="w">        </span><span class="s1">&#39;CRITICAL&#39;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;section&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="s1">&#39;ERROR&#39;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;error&quot;</span><span class="w"></span>

<span class="w">    </span><span class="err">}</span><span class="w"></span>

<span class="w">    </span><span class="n">COLORS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"></span>

<span class="w">        </span><span class="s1">&#39;WARNING&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">AnsiColor</span><span class="p">.</span><span class="n">YELLOW</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="s1">&#39;INFO&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">AnsiColor</span><span class="p">.</span><span class="n">CYAN</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="s1">&#39;DEBUG&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">AnsiColor</span><span class="p">.</span><span class="n">BLUE</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="s1">&#39;CRITICAL&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">AnsiColor</span><span class="p">.</span><span class="n">LIGHTWHITE_EX</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="s1">&#39;ERROR&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">AnsiColor</span><span class="p">.</span><span class="n">RED</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;STATUS&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">AnsiColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;PROGRESS&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">AnsiColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;SECTION&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">AnsiColor</span><span class="p">.</span><span class="n">CYAN</span><span class="w"></span>

<span class="w">    </span><span class="err">}</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="o">=</span><span class="ss">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">use_azure</span><span class="o">=</span><span class="k">False</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">logging</span><span class="p">.</span><span class="n">Formatter</span><span class="p">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">use_azure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">use_azure</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="nf">format</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">record</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">levelname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">record</span><span class="p">.</span><span class="n">levelname</span><span class="w"></span>

<span class="w">        </span><span class="n">org_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">record</span><span class="p">.</span><span class="n">msg</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">use_azure</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">levelname</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ColoredFormatter</span><span class="p">.</span><span class="nl">COLORS</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">level</span><span class="w"> </span><span class="n">name</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">record</span><span class="p">.</span><span class="n">levelno</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">logging</span><span class="p">.</span><span class="nl">WARNING</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">levelname_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_ansi_string</span><span class="p">(</span><span class="n">ColoredFormatter</span><span class="p">.</span><span class="n">COLORS</span><span class="o">[</span><span class="n">levelname</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">levelname</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">get_ansi_string</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">wholes</span><span class="w"> </span><span class="n">message</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">levelname_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_ansi_string</span><span class="p">(</span><span class="n">ColoredFormatter</span><span class="p">.</span><span class="n">COLORS</span><span class="o">[</span><span class="n">levelname</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">levelname</span><span class="w"></span>

<span class="w">                </span><span class="n">record</span><span class="p">.</span><span class="n">msg</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">get_ansi_string</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">record</span><span class="p">.</span><span class="n">levelname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelname_color</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">use_azure</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">levelname</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ColoredFormatter</span><span class="p">.</span><span class="nl">AZURE_COLORS</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">levelname_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;##[&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">\</span><span class="w"></span>

<span class="w">                </span><span class="n">ColoredFormatter</span><span class="p">.</span><span class="n">AZURE_COLORS</span><span class="o">[</span><span class="n">levelname</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">&quot;]&quot;</span><span class="w"></span>

<span class="w">            </span><span class="n">record</span><span class="p">.</span><span class="n">levelname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelname_color</span><span class="w"></span>

<span class="w">        </span><span class="k">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logging</span><span class="p">.</span><span class="n">Formatter</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">record</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">record</span><span class="p">.</span><span class="n">levelname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelname</span><span class="w"></span>

<span class="w">        </span><span class="n">record</span><span class="p">.</span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">org_message</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">result</span><span class="w"></span>
</code></pre></div>


</details>
<hr />
<h4 id="ancestors-in-mro_1">Ancestors (in MRO)</h4>
<ul>
<li>logging.Formatter</li>
</ul>
<h4 id="class-variables_2">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">AZURE_COLORS</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">COLORS</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">default_msec_format</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">default_time_format</span>
</code></pre></div>


<h4 id="methods">Methods</h4>
<h4 id="converter">converter</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">converter</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>


<p>localtime([seconds]) -&gt; (tm_year,tm_mon,tm_mday,tm_hour,tm_min,
                          tm_sec,tm_wday,tm_yday,tm_isdst)</p>
<p>Convert seconds since the Epoch to a time tuple expressing local time.
When &lsquo;seconds&rsquo; is not passed in, convert the current time instead.</p>
<h4 id="format">format</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">format</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">record</span>
<span class="p">)</span>
</code></pre></div>


<p>Format the specified record as text.</p>
<p>The record&rsquo;s attribute dictionary is used as the operand to a
string formatting operation which yields the returned string.
Before formatting the dictionary, a couple of preparatory steps
are carried out. The message attribute of the record is computed
using LogRecord.getMessage(). If the formatting string uses the
time (as determined by a call to usesTime(), formatTime() is
called to format the event time. If there is exception information,
it is formatted using formatException() and appended to the message.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="nf">format</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">record</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">levelname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">record</span><span class="p">.</span><span class="n">levelname</span><span class="w"></span>

<span class="w">        </span><span class="n">org_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">record</span><span class="p">.</span><span class="n">msg</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">use_azure</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">levelname</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ColoredFormatter</span><span class="p">.</span><span class="nl">COLORS</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">level</span><span class="w"> </span><span class="n">name</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">record</span><span class="p">.</span><span class="n">levelno</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">logging</span><span class="p">.</span><span class="nl">WARNING</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">levelname_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_ansi_string</span><span class="p">(</span><span class="n">ColoredFormatter</span><span class="p">.</span><span class="n">COLORS</span><span class="o">[</span><span class="n">levelname</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">levelname</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">get_ansi_string</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">wholes</span><span class="w"> </span><span class="n">message</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">levelname_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_ansi_string</span><span class="p">(</span><span class="n">ColoredFormatter</span><span class="p">.</span><span class="n">COLORS</span><span class="o">[</span><span class="n">levelname</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">levelname</span><span class="w"></span>

<span class="w">                </span><span class="n">record</span><span class="p">.</span><span class="n">msg</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">get_ansi_string</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">record</span><span class="p">.</span><span class="n">levelname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelname_color</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">use_azure</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">levelname</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ColoredFormatter</span><span class="p">.</span><span class="nl">AZURE_COLORS</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">levelname_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;##[&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">\</span><span class="w"></span>

<span class="w">                </span><span class="n">ColoredFormatter</span><span class="p">.</span><span class="n">AZURE_COLORS</span><span class="o">[</span><span class="n">levelname</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">&quot;]&quot;</span><span class="w"></span>

<span class="w">            </span><span class="n">record</span><span class="p">.</span><span class="n">levelname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelname_color</span><span class="w"></span>

<span class="w">        </span><span class="k">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logging</span><span class="p">.</span><span class="n">Formatter</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">record</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">record</span><span class="p">.</span><span class="n">levelname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelname</span><span class="w"></span>

<span class="w">        </span><span class="n">record</span><span class="p">.</span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">org_message</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">result</span><span class="w"></span>
</code></pre></div>


</details>
<h4 id="formatexception">formatException</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">formatException</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ei</span>
<span class="p">)</span>
</code></pre></div>


<p>Format and return the specified exception information as a string.</p>
<p>This default implementation just uses
traceback.print_exception()</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="s s-Atom">def</span> <span class="nf">formatException</span><span class="p">(</span><span class="s s-Atom">self</span><span class="p">,</span> <span class="s s-Atom">ei</span><span class="p">)</span><span class="s s-Atom">:</span>

        <span class="s2">&quot;&quot;&quot;</span>

<span class="s2">        Format and return the specified exception information as a string.</span>

<span class="s2">        This default implementation just uses</span>

<span class="s2">        traceback.print_exception()</span>

<span class="s2">        &quot;&quot;&quot;</span>

        <span class="s s-Atom">sio</span> <span class="o">=</span> <span class="s s-Atom">io</span><span class="p">.</span><span class="nv">StringIO</span><span class="p">()</span>

        <span class="s s-Atom">tb</span> <span class="o">=</span> <span class="s s-Atom">ei</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="s s-Atom">#</span> <span class="nv">See</span> <span class="s s-Atom">issues</span> <span class="s s-Atom">#</span><span class="mi">9427</span><span class="p">,</span> <span class="s s-Atom">#</span><span class="mf">1553375.</span> <span class="nv">Commented</span> <span class="s s-Atom">out</span> <span class="s s-Atom">for</span> <span class="s s-Atom">now</span><span class="p">.</span>

        <span class="s s-Atom">#if</span> <span class="nf">getattr</span><span class="p">(</span><span class="s s-Atom">self</span><span class="p">,</span> <span class="s s-Atom">&#39;fullstack&#39;</span><span class="p">,</span> <span class="nv">False</span><span class="p">)</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">#</span>    <span class="s s-Atom">traceback</span><span class="p">.</span><span class="nf">print_stack</span><span class="p">(</span><span class="s s-Atom">tb</span><span class="p">.</span><span class="s s-Atom">tb_frame</span><span class="p">.</span><span class="s s-Atom">f_back</span><span class="p">,</span> <span class="s s-Atom">file</span><span class="o">=</span><span class="s s-Atom">sio</span><span class="p">)</span>

        <span class="s s-Atom">traceback</span><span class="p">.</span><span class="nf">print_exception</span><span class="p">(</span><span class="s s-Atom">ei</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s s-Atom">ei</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s s-Atom">tb</span><span class="p">,</span> <span class="nv">None</span><span class="p">,</span> <span class="s s-Atom">sio</span><span class="p">)</span>

        <span class="s s-Atom">s</span> <span class="o">=</span> <span class="s s-Atom">sio</span><span class="p">.</span><span class="nf">getvalue</span><span class="p">()</span>

        <span class="s s-Atom">sio</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

        <span class="s s-Atom">if</span> <span class="s s-Atom">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="s s-Atom">:</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;\n&quot;</span><span class="s s-Atom">:</span>

            <span class="s s-Atom">s</span> <span class="o">=</span> <span class="s s-Atom">s</span><span class="p">[:-</span><span class="mi">1</span><span class="p">]</span>

        <span class="s s-Atom">return</span> <span class="s s-Atom">s</span>
</code></pre></div>


</details>
<h4 id="formatmessage">formatMessage</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">formatMessage</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">record</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">formatMessage</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>

        <span class="k">return</span> <span class="k">self</span><span class="p">.</span><span class="n">_style</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="formatstack">formatStack</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">formatStack</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">stack_info</span>
<span class="p">)</span>
</code></pre></div>


<p>This method is provided as an extension point for specialized
formatting of stack information.</p>
<p>The input data is a string as returned from a call to
:func:<code class="codehilite"><span class="err">traceback.print_stack</span></code>, but with the last trailing newline
removed.</p>
<p>The base implementation just returns the value passed in.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">formatStack</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        This method is provided as an extension point for specialized</span>

<span class="ss">        formatting of stack information.</span>

<span class="ss">        The input data is a string as returned from a call to</span>

<span class="ss">        :func:`traceback.print_stack`, but with the last trailing newline</span>

<span class="ss">        removed.</span>

<span class="ss">        The base implementation just returns the value passed in.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">stack_info</span>
</code></pre></div>


</details>
<h4 id="formattime">formatTime</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">formatTime</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">record</span><span class="p">,</span>
    <span class="n">datefmt</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>


<p>Return the creation time of the specified LogRecord as formatted text.</p>
<p>This method should be called from format() by a formatter which
wants to make use of a formatted time. This method can be overridden
in formatters to provide for any specific requirement, but the
basic behaviour is as follows: if datefmt (a string) is specified,
it is used with time.strftime() to format the creation time of the
record. Otherwise, an ISO8601-like (or RFC 3339-like) format is used.
The resulting string is returned. This function uses a user-configurable
function to convert the creation time to a tuple. By default,
time.localtime() is used; to change this for a particular formatter
instance, set the &lsquo;converter&rsquo; attribute to a function with the same
signature as time.localtime() or time.gmtime(). To change it for all
formatters, for example if you want all logging times to be shown in GMT,
set the &lsquo;converter&rsquo; attribute in the Formatter class.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">formatTime</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="k">None</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Return the creation time of the specified LogRecord as formatted text.</span>

<span class="ss">        This method should be called from format() by a formatter which</span>

<span class="ss">        wants to make use of a formatted time. This method can be overridden</span>

<span class="ss">        in formatters to provide for any specific requirement, but the</span>

<span class="ss">        basic behaviour is as follows: if datefmt (a string) is specified,</span>

<span class="ss">        it is used with time.strftime() to format the creation time of the</span>

<span class="ss">        record. Otherwise, an ISO8601-like (or RFC 3339-like) format is used.</span>

<span class="ss">        The resulting string is returned. This function uses a user-configurable</span>

<span class="ss">        function to convert the creation time to a tuple. By default,</span>

<span class="ss">        time.localtime() is used; to change this for a particular formatter</span>

<span class="ss">        instance, set the &#39;converter&#39; attribute to a function with the same</span>

<span class="ss">        signature as time.localtime() or time.gmtime(). To change it for all</span>

<span class="ss">        formatters, for example if you want all logging times to be shown in GMT,</span>

<span class="ss">        set the &#39;converter&#39; attribute in the Formatter class.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="n">ct</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">converter</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">created</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">datefmt</span><span class="p">:</span>

            <span class="n">s</span> <span class="o">=</span> <span class="k">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">datefmt</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">t</span> <span class="o">=</span> <span class="k">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">default_time_format</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>

            <span class="n">s</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">default_msec_format</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">record</span><span class="p">.</span><span class="n">msecs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">s</span>
</code></pre></div>


</details>
<h4 id="usestime">usesTime</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">usesTime</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<p>Check if the format uses the creation time of the record.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">usesTime</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Check if the format uses the creation time of the record.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="k">self</span><span class="p">.</span><span class="n">_style</span><span class="p">.</span><span class="n">usesTime</span><span class="p">()</span>
</code></pre></div>


</details>
<h3 id="coloredstreamhandler">ColoredStreamHandler</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ColoredStreamHandler</span><span class="p">(</span>
    <span class="n">stream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">strip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">convert</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>


<p>A handler class which writes logging records, appropriately formatted,
to a stream. Note that this class does not close the stream, as
sys.stdout or sys.stderr may be used.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">ColoredStreamHandler</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">StreamHandler</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="k">Sequence</span><span class="w"> </span><span class="n">Introducer</span><span class="w"></span>

<span class="w">    </span><span class="n">ANSI_CSI_RE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;\001?\033\\[((?:\\d|;)*)([a-zA-Z])\002?&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">stream</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="n">strip</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nf">convert</span><span class="o">=</span><span class="k">None</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">logging</span><span class="p">.</span><span class="n">StreamHandler</span><span class="p">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">stream</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">on_windows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetHostInfo</span><span class="p">().</span><span class="n">os</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">&quot;Windows&quot;</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">WinAPI</span><span class="w"> </span><span class="n">works</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">Windows</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">doesn</span><span class="s1">&#39;t support the WinAPI</span>

<span class="s1">        # (e.g. Cygwin Terminal). In this case it&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ANSI</span><span class="w"> </span><span class="n">codes</span><span class="p">.</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">conversion_supported</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">on_windows</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">winapi_test</span><span class="p">())</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">strip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">strip</span><span class="w"> </span><span class="n">ANSI</span><span class="w"> </span><span class="n">sequences</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="k">output</span><span class="vm">?</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">strip</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">strip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">conversion_supported</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="n">closed</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="n">isatty</span><span class="p">())</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">strip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strip</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="nf">convert</span><span class="w"> </span><span class="n">ANSI</span><span class="w"> </span><span class="n">sequences</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">win32</span><span class="w"> </span><span class="n">calls</span><span class="vm">?</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">convert</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">convert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">conversion_supported</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="n">closed</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="n">isatty</span><span class="p">())</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="nf">convert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">convert</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">win32_calls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stream</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">on_windows</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">win32_calls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">get_win32_calls</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_light</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">GetConsoleScreenBufferInfo</span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">STDOUT</span><span class="p">).</span><span class="n">wAttributes</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">set_attrs</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_default</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_default_fore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_fore</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_default_back</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_back</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_default_style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_style</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">handle</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">record</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Conditionally emit the specified logging record.</span>

<span class="ss">        Emission depends on filters which may have been added to the handler.</span>

<span class="ss">        Wrap the actual emission of the record with acquisition/release of</span>

<span class="ss">        the I/O thread lock. Returns whether the filter passed the record for</span>

<span class="ss">        emission.</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">rv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">filter</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">record</span><span class="p">.</span><span class="n">levelno</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">level</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">emit</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="nl">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="k">release</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">rv</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_win32_calls</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nf">convert</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="err">{</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BLACK</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BLACK</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">RED</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">RED</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">GREEN</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">YELLOW</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">YELLOW</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BLUE</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BLUE</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">MAGENTA</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">MAGENTA</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">CYAN</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">CYAN</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">WHITE</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">GREY</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">RESET</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">LIGHTBLACK_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BLACK</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">LIGHTRED_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">RED</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">LIGHTGREEN_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">LIGHTYELLOW_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">YELLOW</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">LIGHTBLUE_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BLUE</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">LIGHTMAGENTA_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">MAGENTA</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">LIGHTCYAN_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">CYAN</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">LIGHTWHITE_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">GREY</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_BLACK</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BLACK</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_RED</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">RED</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_GREEN</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_YELLOW</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">YELLOW</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_BLUE</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BLUE</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_MAGENTA</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">MAGENTA</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_CYAN</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">CYAN</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_WHITE</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">GREY</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_RESET</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_LIGHTBLACK_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BLACK</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_LIGHTRED_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">RED</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_LIGHTGREEN_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_LIGHTYELLOW_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">YELLOW</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_LIGHTBLUE_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BLUE</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_LIGHTMAGENTA_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">MAGENTA</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_LIGHTCYAN_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">CYAN</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                </span><span class="n">AnsiColor</span><span class="p">.</span><span class="nl">BG_LIGHTWHITE_EX</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">GREY</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">            </span><span class="err">}</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dict</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">win32</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">foreground</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_foreground</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">fore</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="n">light</span><span class="o">=</span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="n">on_stderr</span><span class="o">=</span><span class="k">False</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">fore</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">fore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_default_fore</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_fore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fore</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Emulate</span><span class="w"> </span><span class="n">LIGHT_EX</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">BRIGHT</span><span class="w"> </span><span class="n">Style</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">light</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_light</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_light</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">set_console</span><span class="p">(</span><span class="n">on_stderr</span><span class="o">=</span><span class="n">on_stderr</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">win32</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">background</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_background</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">back</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="n">light</span><span class="o">=</span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="n">on_stderr</span><span class="o">=</span><span class="k">False</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">back</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_default_back</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_back</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">back</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Emulate</span><span class="w"> </span><span class="n">LIGHT_EX</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">BRIGHT_BACKGROUND</span><span class="w"> </span><span class="n">Style</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">light</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_light</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT_BACKGROUND</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_light</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT_BACKGROUND</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">set_console</span><span class="p">(</span><span class="n">on_stderr</span><span class="o">=</span><span class="n">on_stderr</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">win32</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">console</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="n">attribute</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_console</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="n">on_stderr</span><span class="o">=</span><span class="k">False</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">attrs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">attrs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">get_attrs</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">STDOUT</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">on_stderr</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">STDERR</span><span class="w"></span>

<span class="w">        </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">SetConsoleTextAttribute</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">colors</span><span class="w"> </span><span class="n">selected</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_attrs</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_fore</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_back</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_style</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_light</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">sets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">attributes</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">colors</span><span class="w"> </span><span class="n">selected</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_attrs</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_fore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_back</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT_BACKGROUND</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">writes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="n">stripping</span><span class="w"> </span><span class="n">ANSI</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nc">text</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">strip</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nf">convert</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">write_and_convert</span><span class="p">(</span><span class="nc">text</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">write_plain_text</span><span class="p">(</span><span class="nc">text</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">strip</span><span class="w"> </span><span class="n">stripping</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">converting</span><span class="w"> </span><span class="n">ANSI</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_and_convert</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nc">text</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="nc">cursor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">ANSI_CSI_RE</span><span class="p">.</span><span class="n">finditer</span><span class="p">(</span><span class="nc">text</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">start</span><span class="p">,</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">match</span><span class="p">.</span><span class="n">span</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nc">cursor</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">start</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">write_plain_text</span><span class="p">(</span><span class="nc">text</span><span class="p">,</span><span class="w"> </span><span class="nc">cursor</span><span class="p">,</span><span class="w"> </span><span class="k">start</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">convert_ansi</span><span class="p">(</span><span class="o">*</span><span class="k">match</span><span class="p">.</span><span class="n">groups</span><span class="p">())</span><span class="w"></span>

<span class="w">            </span><span class="nc">cursor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">end</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">write_plain_text</span><span class="p">(</span><span class="nc">text</span><span class="p">,</span><span class="w"> </span><span class="nc">cursor</span><span class="p">,</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="nc">text</span><span class="p">))</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">writes</span><span class="w"> </span><span class="n">plain</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">stream</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_plain_text</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nc">text</span><span class="p">,</span><span class="w"> </span><span class="k">start</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="k">end</span><span class="o">=</span><span class="k">None</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">start</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="nc">text</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="k">start</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">end</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="nc">text</span><span class="o">[</span><span class="n">start:end</span><span class="o">]</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">converts</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ANSI</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">win32</span><span class="w"> </span><span class="n">command</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">convert_ansi</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">paramstring</span><span class="p">,</span><span class="w"> </span><span class="n">command</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nf">convert</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">extract_params</span><span class="p">(</span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">paramstring</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">call_win32</span><span class="p">(</span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">extracts</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">parameters</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ANSI</span><span class="w"> </span><span class="n">command</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">extract_params</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">paramstring</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="nc">int</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">paramstring</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">,)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">params</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">win32</span><span class="w"> </span><span class="n">apis</span><span class="w"> </span><span class="n">set_foreground</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">set_background</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">call_win32</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;m&#39;</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">param</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">params</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">win32_calls</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">func_args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">win32_calls</span><span class="o">[</span><span class="n">param</span><span class="o">]</span><span class="w"></span>

<span class="w">                    </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func_args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"></span>

<span class="w">                    </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func_args</span><span class="o">[</span><span class="n">1:</span><span class="o">]</span><span class="w"></span>

<span class="w">                    </span><span class="n">kwargs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="p">()</span><span class="w"></span>

<span class="w">                    </span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">logging</span><span class="p">.</span><span class="n">handler</span><span class="w"> </span><span class="k">method</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">overriding</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">emit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">record</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">emit</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">record</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">record</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"></span>

<span class="w">            </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">terminator</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">handleError</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="w"></span>
</code></pre></div>


</details>
<hr />
<h4 id="ancestors-in-mro_2">Ancestors (in MRO)</h4>
<ul>
<li>logging.StreamHandler</li>
<li>logging.Handler</li>
<li>logging.Filterer</li>
</ul>
<h4 id="class-variables_3">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">ANSI_CSI_RE</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">terminator</span>
</code></pre></div>


<h4 id="instance-variables">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">name</span>
</code></pre></div>


<h4 id="methods_1">Methods</h4>
<h4 id="acquire">acquire</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">acquire</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<p>Acquire the I/O thread lock.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">acquire</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Acquire the I/O thread lock.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="k">lock</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="k">lock</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>
</code></pre></div>


</details>
<h4 id="addfilter">addFilter</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">addFilter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="nb">filter</span>
<span class="p">)</span>
</code></pre></div>


<p>Add the specified filter to this handler.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">addFilter</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">filter</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Add the specified filter to this handler.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="k">not</span> <span class="p">(</span><span class="n">filter</span> <span class="k">in</span> <span class="k">self</span><span class="p">.</span><span class="n">filters</span><span class="p">):</span>

            <span class="k">self</span><span class="p">.</span><span class="n">filters</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">filter</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="call_win32">call_win32</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">call_win32</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">command</span><span class="p">,</span>
    <span class="n">params</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">call_win32</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;m&#39;</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">param</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">params</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">win32_calls</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">func_args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">win32_calls</span><span class="o">[</span><span class="n">param</span><span class="o">]</span><span class="w"></span>

<span class="w">                    </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func_args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"></span>

<span class="w">                    </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func_args</span><span class="o">[</span><span class="n">1:</span><span class="o">]</span><span class="w"></span>

<span class="w">                    </span><span class="n">kwargs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="p">()</span><span class="w"></span>

<span class="w">                    </span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>
</code></pre></div>


</details>
<h4 id="close">close</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">close</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<p>Tidy up any resources used by the handler.</p>
<p>This version removes the handler from an internal map of handlers,
_handlers, which is used for handler lookup by name. Subclasses
should ensure that this gets called from overridden close()
methods.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="k">close</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Tidy up any resources used by the handler.</span>

<span class="ss">        This version removes the handler from an internal map of handlers,</span>

<span class="ss">        _handlers, which is used for handler lookup by name. Subclasses</span>

<span class="ss">        should ensure that this gets called from overridden close()</span>

<span class="ss">        methods.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="o">#</span><span class="k">get</span> <span class="n">the</span> <span class="n">module</span> <span class="k">data</span> <span class="k">lock</span><span class="p">,</span> <span class="k">as</span> <span class="n">we</span><span class="err">&#39;</span><span class="n">re</span> <span class="n">updating</span> <span class="n">a</span> <span class="n">shared</span> <span class="k">structure</span><span class="p">.</span>

        <span class="n">_acquireLock</span><span class="p">()</span>

        <span class="n">try</span><span class="p">:</span>    <span class="o">#</span><span class="n">unlikely</span> <span class="k">to</span> <span class="n">raise</span> <span class="n">an</span> <span class="k">exception</span><span class="p">,</span> <span class="n">but</span> <span class="n">you</span> <span class="n">never</span> <span class="n">know</span><span class="p">...</span>

            <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="n">_name</span> <span class="k">and</span> <span class="k">self</span><span class="p">.</span><span class="n">_name</span> <span class="k">in</span> <span class="n">_handlers</span><span class="p">:</span>

                <span class="n">del</span> <span class="n">_handlers</span><span class="p">[</span><span class="k">self</span><span class="p">.</span><span class="n">_name</span><span class="p">]</span>

        <span class="n">finally</span><span class="p">:</span>

            <span class="n">_releaseLock</span><span class="p">()</span>
</code></pre></div>


</details>
<h4 id="convert_ansi">convert_ansi</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">convert_ansi</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">paramstring</span><span class="p">,</span>
    <span class="n">command</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">convert_ansi</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">paramstring</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>

        <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="k">convert</span><span class="p">:</span>

            <span class="n">params</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">extract_params</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">paramstring</span><span class="p">)</span>

            <span class="k">self</span><span class="p">.</span><span class="n">call_win32</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="createlock">createLock</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">createLock</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<p>Acquire a thread lock for serializing access to the underlying I/O.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">createLock</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Acquire a thread lock for serializing access to the underlying I/O.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">self</span><span class="p">.</span><span class="k">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">RLock</span><span class="p">()</span>

        <span class="n">_register_at_fork_reinit_lock</span><span class="p">(</span><span class="k">self</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="emit">emit</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">emit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">record</span>
<span class="p">)</span>
</code></pre></div>


<p>Emit a record.</p>
<p>If a formatter is specified, it is used to format the record.
The record is then written to the stream with a trailing newline.  If
exception information is present, it is formatted using
traceback.print_exception and appended to the stream.  If the stream
has an &lsquo;encoding&rsquo; attribute, it is used to determine how to do the
output to the stream.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">emit</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>

        <span class="n">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">record</span> <span class="k">is</span> <span class="k">None</span><span class="p">:</span>

                <span class="k">return</span>

            <span class="n">msg</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">msg</span> <span class="k">is</span> <span class="k">None</span><span class="p">:</span>

                <span class="k">return</span>

            <span class="k">self</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>

            <span class="k">self</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">terminator</span><span class="p">)</span>

            <span class="k">self</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="k">except</span> <span class="k">Exception</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">handleError</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="extract_params">extract_params</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">extract_params</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">command</span><span class="p">,</span>
    <span class="n">paramstring</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">extract_params</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">paramstring</span><span class="p">):</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="k">in</span> <span class="n">paramstring</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,)</span>

        <span class="k">return</span> <span class="n">params</span>
</code></pre></div>


</details>
<h4 id="filter">filter</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">filter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">record</span>
<span class="p">)</span>
</code></pre></div>


<p>Determine if a record is loggable by consulting all the filters.</p>
<p>The default is to allow the record to be logged; any filter can veto
this and the record is then dropped. Returns a zero value if a record
is to be dropped, else non-zero.</p>
<p>.. versionchanged:: 3.2</p>
<p>Allow filters to be just callables.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">filter</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Determine if a record is loggable by consulting all the filters.</span>

<span class="ss">        The default is to allow the record to be logged; any filter can veto</span>

<span class="ss">        this and the record is then dropped. Returns a zero value if a record</span>

<span class="ss">        is to be dropped, else non-zero.</span>

<span class="ss">        .. versionchanged:: 3.2</span>

<span class="ss">           Allow filters to be just callables.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="n">rv</span> <span class="o">=</span> <span class="k">True</span>

        <span class="k">for</span> <span class="n">f</span> <span class="k">in</span> <span class="k">self</span><span class="p">.</span><span class="n">filters</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">hasattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;filter&#39;</span><span class="p">):</span>

                <span class="k">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">filter</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="o">#</span> <span class="n">assume</span> <span class="n">callable</span> <span class="o">-</span> <span class="n">will</span> <span class="n">raise</span> <span class="k">if</span> <span class="k">not</span>

            <span class="k">if</span> <span class="k">not</span> <span class="k">result</span><span class="p">:</span>

                <span class="n">rv</span> <span class="o">=</span> <span class="k">False</span>

                <span class="n">break</span>

        <span class="k">return</span> <span class="n">rv</span>
</code></pre></div>


</details>
<h4 id="flush">flush</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">flush</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<p>Flushes the stream.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">flush</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Flushes the stream.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">self</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>

        <span class="n">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="n">stream</span> <span class="k">and</span> <span class="n">hasattr</span><span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">stream</span><span class="p">,</span> <span class="ss">&quot;flush&quot;</span><span class="p">):</span>

                <span class="k">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="n">finally</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>
</code></pre></div>


</details>
<h4 id="format_1">format</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">format</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">record</span>
<span class="p">)</span>
</code></pre></div>


<p>Format the specified record.</p>
<p>If a formatter is set, use it. Otherwise, use the default formatter
for the module.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">format</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Format the specified record.</span>

<span class="ss">        If a formatter is set, use it. Otherwise, use the default formatter</span>

<span class="ss">        for the module.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="n">formatter</span><span class="p">:</span>

            <span class="n">fmt</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">formatter</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">fmt</span> <span class="o">=</span> <span class="n">_defaultFormatter</span>

        <span class="k">return</span> <span class="n">fmt</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="get_attrs">get_attrs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_attrs</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">get_attrs</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="k">self</span><span class="p">.</span><span class="n">_fore</span> <span class="o">+</span> <span class="k">self</span><span class="p">.</span><span class="n">_back</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">+</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">_style</span> <span class="o">|</span> <span class="k">self</span><span class="p">.</span><span class="n">_light</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="get_name">get_name</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">get_name</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="k">self</span><span class="p">.</span><span class="n">_name</span>
</code></pre></div>


</details>
<h4 id="get_win32_calls">get_win32_calls</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_win32_calls</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">get_win32_calls</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="k">convert</span><span class="p">:</span>

            <span class="k">return</span> <span class="err">{</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BLACK</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BLACK</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">RED</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">RED</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">YELLOW</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">YELLOW</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BLUE</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BLUE</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">MAGENTA</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">MAGENTA</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">CYAN</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">CYAN</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">WHITE</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">GREY</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="k">RESET</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="k">None</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">LIGHTBLACK_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BLACK</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">LIGHTRED_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">RED</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">LIGHTGREEN_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">LIGHTYELLOW_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">YELLOW</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">LIGHTBLUE_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BLUE</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">LIGHTMAGENTA_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">MAGENTA</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">LIGHTCYAN_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">CYAN</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">LIGHTWHITE_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_foreground</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">GREY</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_BLACK</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BLACK</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_RED</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">RED</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_GREEN</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_YELLOW</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">YELLOW</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_BLUE</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BLUE</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_MAGENTA</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">MAGENTA</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_CYAN</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">CYAN</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_WHITE</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">GREY</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_RESET</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="k">None</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_LIGHTBLACK_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BLACK</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_LIGHTRED_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">RED</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_LIGHTGREEN_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">GREEN</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_LIGHTYELLOW_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">YELLOW</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_LIGHTBLUE_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BLUE</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_LIGHTMAGENTA_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">MAGENTA</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_LIGHTCYAN_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">CYAN</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

                <span class="n">AnsiColor</span><span class="p">.</span><span class="n">BG_LIGHTWHITE_EX</span><span class="p">:</span> <span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">set_background</span><span class="p">,</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">GREY</span><span class="p">,</span> <span class="k">True</span><span class="p">),</span>

            <span class="err">}</span>

        <span class="k">return</span> <span class="n">dict</span><span class="p">()</span>
</code></pre></div>


</details>
<h4 id="handle">handle</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">handle</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">record</span>
<span class="p">)</span>
</code></pre></div>


<p>Conditionally emit the specified logging record.
Emission depends on filters which may have been added to the handler.
Wrap the actual emission of the record with acquisition/release of
the I/O thread lock. Returns whether the filter passed the record for
emission.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">handle</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Conditionally emit the specified logging record.</span>

<span class="ss">        Emission depends on filters which may have been added to the handler.</span>

<span class="ss">        Wrap the actual emission of the record with acquisition/release of</span>

<span class="ss">        the I/O thread lock. Returns whether the filter passed the record for</span>

<span class="ss">        emission.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="n">rv</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">filter</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rv</span> <span class="k">and</span> <span class="n">record</span><span class="p">.</span><span class="n">levelno</span> <span class="o">&gt;=</span> <span class="k">self</span><span class="p">.</span><span class="k">level</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>

            <span class="n">try</span><span class="p">:</span>

                <span class="k">self</span><span class="p">.</span><span class="n">emit</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

            <span class="n">finally</span><span class="p">:</span>

                <span class="k">self</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">rv</span>
</code></pre></div>


</details>
<h4 id="handleerror">handleError</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">handleError</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">record</span>
<span class="p">)</span>
</code></pre></div>


<p>Handle errors which occur during an emit() call.</p>
<p>This method should be called from handlers when an exception is
encountered during an emit() call. If raiseExceptions is false,
exceptions get silently ignored. This is what is mostly wanted
for a logging system - most users will not care about errors in
the logging system, they are more interested in application errors.
You could, however, replace this with a custom handler if you wish.
The record which was being processed is passed in to this method.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">handleError</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Handle errors which occur during an emit() call.</span>

<span class="ss">        This method should be called from handlers when an exception is</span>

<span class="ss">        encountered during an emit() call. If raiseExceptions is false,</span>

<span class="ss">        exceptions get silently ignored. This is what is mostly wanted</span>

<span class="ss">        for a logging system - most users will not care about errors in</span>

<span class="ss">        the logging system, they are more interested in application errors.</span>

<span class="ss">        You could, however, replace this with a custom handler if you wish.</span>

<span class="ss">        The record which was being processed is passed in to this method.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">raiseExceptions</span> <span class="k">and</span> <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">:</span>  <span class="o">#</span> <span class="n">see</span> <span class="n">issue</span> <span class="mi">13807</span>

            <span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">tb</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">exc_info</span><span class="p">()</span>

            <span class="n">try</span><span class="p">:</span>

                <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="s1">&#39;--- Logging error ---\n&#39;</span><span class="p">)</span>

                <span class="n">traceback</span><span class="p">.</span><span class="n">print_exception</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">tb</span><span class="p">,</span> <span class="k">None</span><span class="p">,</span> <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">)</span>

                <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="s1">&#39;Call stack:\n&#39;</span><span class="p">)</span>

                <span class="o">#</span> <span class="n">Walk</span> <span class="n">the</span> <span class="n">stack</span> <span class="n">frame</span> <span class="n">up</span> <span class="k">until</span> <span class="n">we</span><span class="s1">&#39;re out of logging,</span>

<span class="s1">                # so as to print the calling context.</span>

<span class="s1">                frame = tb.tb_frame</span>

<span class="s1">                while (frame and os.path.dirname(frame.f_code.co_filename) ==</span>

<span class="s1">                       __path__[0]):</span>

<span class="s1">                    frame = frame.f_back</span>

<span class="s1">                if frame:</span>

<span class="s1">                    traceback.print_stack(frame, file=sys.stderr)</span>

<span class="s1">                else:</span>

<span class="s1">                    # couldn&#39;</span><span class="n">t</span> <span class="n">find</span> <span class="n">the</span> <span class="k">right</span> <span class="n">stack</span> <span class="n">frame</span><span class="p">,</span> <span class="k">for</span> <span class="k">some</span> <span class="n">reason</span>

                    <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="s1">&#39;Logged from file %s, line %s\n&#39;</span> <span class="o">%</span> <span class="p">(</span>

                                     <span class="n">record</span><span class="p">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">record</span><span class="p">.</span><span class="n">lineno</span><span class="p">))</span>

                <span class="o">#</span> <span class="n">Issue</span> <span class="mi">18671</span><span class="p">:</span> <span class="k">output</span> <span class="n">logging</span> <span class="n">message</span> <span class="k">and</span> <span class="n">arguments</span>

                <span class="n">try</span><span class="p">:</span>

                    <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="s1">&#39;Message: %r\n&#39;</span>

                                     <span class="s1">&#39;Arguments: %s\n&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">msg</span><span class="p">,</span>

                                                          <span class="n">record</span><span class="p">.</span><span class="n">args</span><span class="p">))</span>

                <span class="k">except</span> <span class="n">RecursionError</span><span class="p">:</span>  <span class="o">#</span> <span class="n">See</span> <span class="n">issue</span> <span class="mi">36272</span>

                    <span class="n">raise</span>

                <span class="k">except</span> <span class="k">Exception</span><span class="p">:</span>

                    <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="s1">&#39;Unable to print the message and arguments&#39;</span>

                                     <span class="s1">&#39; - possible formatting error.\nUse the&#39;</span>

                                     <span class="s1">&#39; traceback above to help find the error.\n&#39;</span>

                                    <span class="p">)</span>

            <span class="k">except</span> <span class="n">OSError</span><span class="p">:</span> <span class="o">#</span><span class="n">pragma</span><span class="p">:</span> <span class="k">no</span> <span class="n">cover</span>

                <span class="n">pass</span>    <span class="o">#</span> <span class="n">see</span> <span class="n">issue</span> <span class="mi">5971</span>

            <span class="n">finally</span><span class="p">:</span>

                <span class="n">del</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">tb</span>
</code></pre></div>


</details>
<h4 id="release">release</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">release</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<p>Release the I/O thread lock.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">release</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Release the I/O thread lock.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="k">lock</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="k">lock</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>
</code></pre></div>


</details>
<h4 id="removefilter">removeFilter</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">removeFilter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="nb">filter</span>
<span class="p">)</span>
</code></pre></div>


<p>Remove the specified filter from this handler.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">removeFilter</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">filter</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Remove the specified filter from this handler.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">filter</span> <span class="k">in</span> <span class="k">self</span><span class="p">.</span><span class="n">filters</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">filters</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filter</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="setformatter">setFormatter</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">setFormatter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fmt</span>
<span class="p">)</span>
</code></pre></div>


<p>Set the formatter for this handler.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">setFormatter</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Set the formatter for this handler.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">self</span><span class="p">.</span><span class="n">formatter</span> <span class="o">=</span> <span class="n">fmt</span>
</code></pre></div>


</details>
<h4 id="setlevel">setLevel</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">setLevel</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">level</span>
<span class="p">)</span>
</code></pre></div>


<p>Set the logging level of this handler.  level must be an int or a str.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">setLevel</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="k">level</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Set the logging level of this handler.  level must be an int or a str.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">self</span><span class="p">.</span><span class="k">level</span> <span class="o">=</span> <span class="n">_checkLevel</span><span class="p">(</span><span class="k">level</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="setstream">setStream</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">setStream</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">stream</span>
<span class="p">)</span>
</code></pre></div>


<p>Sets the StreamHandler&rsquo;s stream to the specified value,
if it is different.</p>
<p>Returns the old stream, if the stream was changed, or None
if it wasn&rsquo;t.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">setStream</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>

        <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Sets the StreamHandler&#39;s stream to the specified value,</span>

<span class="ss">        if it is different.</span>

<span class="ss">        Returns the old stream, if the stream was changed, or None</span>

<span class="ss">        if it wasn&#39;t.</span>

<span class="ss">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">stream</span> <span class="k">is</span> <span class="k">self</span><span class="p">.</span><span class="n">stream</span><span class="p">:</span>

            <span class="k">result</span> <span class="o">=</span> <span class="k">None</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">result</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">stream</span>

            <span class="k">self</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>

            <span class="n">try</span><span class="p">:</span>

                <span class="k">self</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>

                <span class="k">self</span><span class="p">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span>

            <span class="n">finally</span><span class="p">:</span>

                <span class="k">self</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>

        <span class="k">return</span> <span class="k">result</span>
</code></pre></div>


</details>
<h4 id="set_attrs">set_attrs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_attrs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">value</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">set_attrs</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="k">self</span><span class="p">.</span><span class="n">_fore</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="mi">7</span>

        <span class="k">self</span><span class="p">.</span><span class="n">_back</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span>

        <span class="k">self</span><span class="p">.</span><span class="n">_style</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT</span> <span class="o">|</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT_BACKGROUND</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="set_background">set_background</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_background</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">back</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">light</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">on_stderr</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">set_background</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="k">False</span><span class="p">,</span> <span class="n">on_stderr</span><span class="o">=</span><span class="k">False</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">back</span> <span class="k">is</span> <span class="k">None</span><span class="p">:</span>

            <span class="n">back</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">_default_back</span>

        <span class="k">self</span><span class="p">.</span><span class="n">_back</span> <span class="o">=</span> <span class="n">back</span>

        <span class="o">#</span> <span class="n">Emulate</span> <span class="n">LIGHT_EX</span> <span class="k">with</span> <span class="n">BRIGHT_BACKGROUND</span> <span class="n">Style</span>

        <span class="k">if</span> <span class="n">light</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">_light</span> <span class="o">|=</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT_BACKGROUND</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">_light</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT_BACKGROUND</span>

        <span class="k">self</span><span class="p">.</span><span class="n">set_console</span><span class="p">(</span><span class="n">on_stderr</span><span class="o">=</span><span class="n">on_stderr</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="set_console">set_console</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_console</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">attrs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">on_stderr</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">set_console</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">on_stderr</span><span class="o">=</span><span class="k">False</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">attrs</span> <span class="k">is</span> <span class="k">None</span><span class="p">:</span>

            <span class="n">attrs</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">get_attrs</span><span class="p">()</span>

        <span class="n">handle</span> <span class="o">=</span> <span class="n">Win32Console</span><span class="p">.</span><span class="k">STDOUT</span>

        <span class="k">if</span> <span class="n">on_stderr</span><span class="p">:</span>

            <span class="n">handle</span> <span class="o">=</span> <span class="n">Win32Console</span><span class="p">.</span><span class="n">STDERR</span>

        <span class="n">Win32Console</span><span class="p">.</span><span class="n">SetConsoleTextAttribute</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="set_foreground">set_foreground</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_foreground</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fore</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">light</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">on_stderr</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">set_foreground</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">fore</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="k">False</span><span class="p">,</span> <span class="n">on_stderr</span><span class="o">=</span><span class="k">False</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">fore</span> <span class="k">is</span> <span class="k">None</span><span class="p">:</span>

            <span class="n">fore</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">_default_fore</span>

        <span class="k">self</span><span class="p">.</span><span class="n">_fore</span> <span class="o">=</span> <span class="n">fore</span>

        <span class="o">#</span> <span class="n">Emulate</span> <span class="n">LIGHT_EX</span> <span class="k">with</span> <span class="n">BRIGHT</span> <span class="n">Style</span>

        <span class="k">if</span> <span class="n">light</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">_light</span> <span class="o">|=</span> <span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">_light</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">WinColor</span><span class="p">.</span><span class="n">BRIGHT</span>

        <span class="k">self</span><span class="p">.</span><span class="n">set_console</span><span class="p">(</span><span class="n">on_stderr</span><span class="o">=</span><span class="n">on_stderr</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="set_name">set_name</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_name</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">_acquireLock</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">_handlers</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">del</span><span class="w"> </span><span class="n">_handlers</span><span class="o">[</span><span class="n">self._name</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">_handlers</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="w"></span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">_releaseLock</span><span class="p">()</span><span class="w"></span>
</code></pre></div>


</details>
<h4 id="write">write</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">text</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="k">write</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nb">text</span><span class="p">):</span>

        <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="n">strip</span> <span class="k">or</span> <span class="k">self</span><span class="p">.</span><span class="k">convert</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">write_and_convert</span><span class="p">(</span><span class="nb">text</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">write_plain_text</span><span class="p">(</span><span class="nb">text</span><span class="p">)</span>
</code></pre></div>


</details>
<h4 id="write_and_convert">write_and_convert</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write_and_convert</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">text</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">write_and_convert</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nb">text</span><span class="p">):</span>

        <span class="k">cursor</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="k">match</span> <span class="k">in</span> <span class="k">self</span><span class="p">.</span><span class="n">ANSI_CSI_RE</span><span class="p">.</span><span class="n">finditer</span><span class="p">(</span><span class="nb">text</span><span class="p">):</span>

            <span class="k">start</span><span class="p">,</span> <span class="k">end</span> <span class="o">=</span> <span class="k">match</span><span class="p">.</span><span class="n">span</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">cursor</span> <span class="o">&lt;</span> <span class="k">start</span><span class="p">):</span>

                <span class="k">self</span><span class="p">.</span><span class="n">write_plain_text</span><span class="p">(</span><span class="nb">text</span><span class="p">,</span> <span class="k">cursor</span><span class="p">,</span> <span class="k">start</span><span class="p">)</span>

            <span class="k">self</span><span class="p">.</span><span class="n">convert_ansi</span><span class="p">(</span><span class="o">*</span><span class="k">match</span><span class="p">.</span><span class="n">groups</span><span class="p">())</span>

            <span class="k">cursor</span> <span class="o">=</span> <span class="k">end</span>

        <span class="k">self</span><span class="p">.</span><span class="n">write_plain_text</span><span class="p">(</span><span class="nb">text</span><span class="p">,</span> <span class="k">cursor</span><span class="p">,</span> <span class="n">len</span><span class="p">(</span><span class="nb">text</span><span class="p">))</span>
</code></pre></div>


</details>
<h4 id="write_plain_text">write_plain_text</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write_plain_text</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">text</span><span class="p">,</span>
    <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">end</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">write_plain_text</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nb">text</span><span class="p">,</span> <span class="k">start</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="k">end</span><span class="o">=</span><span class="k">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="k">start</span> <span class="k">is</span> <span class="k">None</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="nb">text</span><span class="p">)</span>

        <span class="n">elif</span> <span class="k">start</span> <span class="o">&lt;</span> <span class="k">end</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="nb">text</span><span class="p">[</span><span class="k">start</span><span class="p">:</span><span class="k">end</span><span class="p">])</span>

        <span class="k">self</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div>


</details>
<h3 id="win32console">Win32Console</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Win32Console</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="k">class</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">(</span><span class="k">object</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">_GetConsoleScreenBufferInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">windll</span><span class="p">.</span><span class="n">kernel32</span><span class="p">.</span><span class="n">GetConsoleScreenBufferInfo</span><span class="w"></span>

<span class="w">        </span><span class="n">_SetConsoleTextAttribute</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">windll</span><span class="p">.</span><span class="n">kernel32</span><span class="p">.</span><span class="n">SetConsoleTextAttribute</span><span class="w"></span>

<span class="w">        </span><span class="n">_SetConsoleTextAttribute</span><span class="p">.</span><span class="n">argtypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n"></span>

<span class="n">            wintypes.HANDLE,</span>

<span class="n">            wintypes.WORD,</span>

<span class="n">        </span><span class="o">]</span><span class="w"></span>

<span class="w">        </span><span class="n">_SetConsoleTextAttribute</span><span class="p">.</span><span class="n">restype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wintypes</span><span class="p">.</span><span class="n">BOOL</span><span class="w"></span>

<span class="w">        </span><span class="n">_GetStdHandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">windll</span><span class="p">.</span><span class="n">kernel32</span><span class="p">.</span><span class="n">GetStdHandle</span><span class="w"></span>

<span class="w">        </span><span class="n">_GetStdHandle</span><span class="p">.</span><span class="n">argtypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n"></span>

<span class="n">            wintypes.DWORD,</span>

<span class="n">        </span><span class="o">]</span><span class="w"></span>

<span class="w">        </span><span class="n">_GetStdHandle</span><span class="p">.</span><span class="n">restype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wintypes</span><span class="p">.</span><span class="n">HANDLE</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">winbase</span><span class="p">.</span><span class="n">h</span><span class="w"></span>

<span class="w">        </span><span class="n">STDOUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">11</span><span class="w"></span>

<span class="w">        </span><span class="n">STDERR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">12</span><span class="w"></span>

<span class="w">        </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_winapi_test</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">csbi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CONSOLE_SCREEN_BUFFER_INFO</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetConsoleScreenBufferInfo</span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">byref</span><span class="p">(</span><span class="n">csbi</span><span class="p">))</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">bool</span><span class="p">(</span><span class="n">success</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">winapi_test</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="ow">any</span><span class="p">(</span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_winapi_test</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="ow">in</span><span class="w"></span>

<span class="w">                       </span><span class="p">(</span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">Win32Console</span><span class="p">.</span><span class="n">STDOUT</span><span class="p">),</span><span class="w"></span>

<span class="w">                        </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">Win32Console</span><span class="p">.</span><span class="n">STDERR</span><span class="p">)))</span><span class="w"></span>

<span class="w">        </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">GetConsoleScreenBufferInfo</span><span class="p">(</span><span class="n">stream_id</span><span class="o">=</span><span class="n">STDOUT</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">stream_id</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">csbi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CONSOLE_SCREEN_BUFFER_INFO</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetConsoleScreenBufferInfo</span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">byref</span><span class="p">(</span><span class="n">csbi</span><span class="p">))</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">csbi</span><span class="w"></span>

<span class="w">        </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">SetConsoleTextAttribute</span><span class="p">(</span><span class="n">stream_id</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">stream_id</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_SetConsoleTextAttribute</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="w"></span>
</code></pre></div>


</details>
<hr />
<h4 id="class-variables_4">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">STDERR</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">STDOUT</span>
</code></pre></div>


<h4 id="static-methods">Static methods</h4>
<h4 id="getconsolescreenbufferinfo">GetConsoleScreenBufferInfo</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">GetConsoleScreenBufferInfo</span><span class="p">(</span>
    <span class="n">stream_id</span><span class="o">=-</span><span class="mi">11</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">        </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">GetConsoleScreenBufferInfo</span><span class="p">(</span><span class="n">stream_id</span><span class="o">=</span><span class="n">STDOUT</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">stream_id</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">csbi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CONSOLE_SCREEN_BUFFER_INFO</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetConsoleScreenBufferInfo</span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">byref</span><span class="p">(</span><span class="n">csbi</span><span class="p">))</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">csbi</span><span class="w"></span>
</code></pre></div>


</details>
<h4 id="setconsoletextattribute">SetConsoleTextAttribute</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">SetConsoleTextAttribute</span><span class="p">(</span>
    <span class="n">stream_id</span><span class="p">,</span>
    <span class="n">attrs</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">        </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">SetConsoleTextAttribute</span><span class="p">(</span><span class="n">stream_id</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">stream_id</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_SetConsoleTextAttribute</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="w"></span>
</code></pre></div>


</details>
<h4 id="winapi_test">winapi_test</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">winapi_test</span><span class="p">(</span>

<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">        </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">winapi_test</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="ow">any</span><span class="p">(</span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_winapi_test</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="ow">in</span><span class="w"></span>

<span class="w">                       </span><span class="p">(</span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">Win32Console</span><span class="p">.</span><span class="n">STDOUT</span><span class="p">),</span><span class="w"></span>

<span class="w">                        </span><span class="n">Win32Console</span><span class="p">.</span><span class="n">_GetStdHandle</span><span class="p">(</span><span class="n">Win32Console</span><span class="p">.</span><span class="n">STDERR</span><span class="p">)))</span><span class="w"></span>
</code></pre></div>


</details>
<h3 id="wincolor">WinColor</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">WinColor</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">WinColor</span>(<span class="n">object</span>):

    <span class="n">BLACK</span> = <span class="mi">0</span>

    <span class="n">BLUE</span> = <span class="mi">1</span>

    <span class="n">GREEN</span> = <span class="mi">2</span>

    <span class="n">CYAN</span> = <span class="mi">3</span>

    <span class="n">RED</span> = <span class="mi">4</span>

    <span class="n">MAGENTA</span> = <span class="mi">5</span>

    <span class="n">YELLOW</span> = <span class="mi">6</span>

    <span class="n">GREY</span> = <span class="mi">7</span>

    <span class="n">NORMAL</span> = <span class="mh">0x00</span>  <span class="c1"># dim text, dim background</span>

    <span class="n">BRIGHT</span> = <span class="mh">0x08</span>  <span class="c1"># bright text, dim background</span>

    <span class="n">BRIGHT_BACKGROUND</span> = <span class="mh">0x80</span>  <span class="c1"># dim text, bright background</span>
</code></pre></div>


</details>
<hr />
<h4 id="class-variables_5">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">BLACK</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BLUE</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BRIGHT</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">BRIGHT_BACKGROUND</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">CYAN</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">GREEN</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">GREY</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">MAGENTA</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">NORMAL</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">RED</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">YELLOW</span>
</code></pre></div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../acpi/" title="Index" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Index
              </span>
            </div>
          </a>
        
        
          <a href="../file_handler/" title="File handler" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                File handler
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright (c) Microsoft.  All rights reserved
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../../.."}})</script>
      
        <script src="../../../js/version-select.js"></script>
      
    
  </body>
</html>